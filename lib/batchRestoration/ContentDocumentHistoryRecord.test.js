
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Mon Apr 29 2019 16:12:38 GMT+0000 (Coordinated Universal Time)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0xfef2=['\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x44\x61\x74\x65','\x75\x73\x65\x73\x20\x74\x68\x65\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e\x73\x20\x67\x72\x61\x78\x6f\x72\x67\x69\x64','\x67\x72\x61\x78\x6f\x72\x67\x69\x64','\x73\x6f\x75\x72\x63\x65\x5f\x67\x72\x61\x78\x69\x64','\x6c\x65\x6e\x67\x74\x68','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2f\x52\x65\x73\x74\x6f\x72\x65\x53\x65\x74','\x2e\x2f\x43\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74\x48\x69\x73\x74\x6f\x72\x79\x52\x65\x63\x6f\x72\x64','\x2e\x2e\x2f\x75\x74\x69\x6c\x2f\x63\x6f\x6d\x70\x75\x74\x65\x47\x72\x61\x78\x49\x64','\x63\x6f\x6e\x74\x65\x6e\x74\x20\x64\x6f\x63\x75\x6d\x65\x6e\x74\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x72\x65\x63\x6f\x72\x64','\x34\x31\x32\x33\x31\x32\x33\x34\x31\x33\x34\x31','\x33\x34\x32\x31\x34\x33\x31\x32\x33\x34\x31\x34','\x33\x34\x32\x31\x32\x31','\x73\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74\x73\x2f\x63\x6f\x6e\x74\x65\x6e\x74\x56\x65\x72\x73\x69\x6f\x6e','\x74\x6f\x42\x75\x6c\x6b\x51\x75\x65\x72\x79\x50\x61\x69\x72','\x64\x6f\x63','\x74\x6f\x45\x71\x75\x61\x6c','\x75\x73\x65\x73\x20\x74\x68\x65\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e\x27\x73\x20\x63\x72\x65\x61\x74\x65\x64\x20\x64\x61\x74\x65','\x43\x72\x65\x61\x74\x65\x64\x44\x61\x74\x65','\x75\x73\x65\x73\x20\x74\x68\x65\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e\x27\x73\x20\x6d\x6f\x64\x69\x66\x69\x65\x64\x20\x64\x61\x74\x65','\x73\x6f\x75\x72\x63\x65\x5f\x4c\x61\x73\x74\x4d\x6f\x64\x69\x66\x69\x65\x64\x44\x61\x74\x65'];(function(_0x4214a5,_0x12f9c4){var _0x40590d=function(_0x13ab6d){while(--_0x13ab6d){_0x4214a5['push'](_0x4214a5['shift']());}};var _0x1b49e1=function(){var _0x163901={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x1981a7,_0x625f4f,_0x346829,_0x3fe72f){_0x3fe72f=_0x3fe72f||{};var _0x2de4f1=_0x625f4f+'='+_0x346829;var _0xea0ef2=0x0;for(var _0xea0ef2=0x0,_0x221818=_0x1981a7['length'];_0xea0ef2<_0x221818;_0xea0ef2++){var _0x78bb6=_0x1981a7[_0xea0ef2];_0x2de4f1+=';\x20'+_0x78bb6;var _0x51b47e=_0x1981a7[_0x78bb6];_0x1981a7['push'](_0x51b47e);_0x221818=_0x1981a7['length'];if(_0x51b47e!==!![]){_0x2de4f1+='='+_0x51b47e;}}_0x3fe72f['cookie']=_0x2de4f1;},'removeCookie':function(){return'dev';},'getCookie':function(_0xc93d8d,_0x15c813){_0xc93d8d=_0xc93d8d||function(_0x299b9b){return _0x299b9b;};var _0xd44782=_0xc93d8d(new RegExp('(?:^|;\x20)'+_0x15c813['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x306cac=function(_0x5dcb93,_0x2cf42f){_0x5dcb93(++_0x2cf42f);};_0x306cac(_0x40590d,_0x12f9c4);return _0xd44782?decodeURIComponent(_0xd44782[0x1]):undefined;}};var _0x5b84b4=function(){var _0xfcb8aa=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xfcb8aa['test'](_0x163901['removeCookie']['toString']());};_0x163901['updateCookie']=_0x5b84b4;var _0x3b9ed1='';var _0x12ddf9=_0x163901['updateCookie']();if(!_0x12ddf9){_0x163901['setCookie'](['*'],'counter',0x1);}else if(_0x12ddf9){_0x3b9ed1=_0x163901['getCookie'](null,'counter');}else{_0x163901['removeCookie']();}};_0x1b49e1();}(_0xfef2,0xb7));var _0x2fef=function(_0x6f041d,_0x4029b4){_0x6f041d=_0x6f041d-0x0;var _0x4609b8=_0xfef2[_0x6f041d];return _0x4609b8;};var _0x3d89cd=function(){var _0x28074b=!![];return function(_0x5b67e8,_0x4ce8e6){var _0xf85022=_0x28074b?function(){if(_0x4ce8e6){var _0x21fd85=_0x4ce8e6['apply'](_0x5b67e8,arguments);_0x4ce8e6=null;return _0x21fd85;}}:function(){};_0x28074b=![];return _0xf85022;};}();var _0xdd5295=_0x3d89cd(this,function(){var _0x1d0ea9=function(){return'\x64\x65\x76';},_0x517114=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x178941=function(){var _0x508f6d=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x508f6d['\x74\x65\x73\x74'](_0x1d0ea9['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x2bb679=function(){var _0x19cbd7=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x19cbd7['\x74\x65\x73\x74'](_0x517114['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1d9bcc=function(_0x4b2f31){var _0x2a29c9=~-0x1>>0x1+0xff%0x0;if(_0x4b2f31['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x2a29c9)){_0x343284(_0x4b2f31);}};var _0x343284=function(_0x1dc329){var _0x3bd524=~-0x4>>0x1+0xff%0x0;if(_0x1dc329['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x3bd524){_0x1d9bcc(_0x1dc329);}};if(!_0x178941()){if(!_0x2bb679()){_0x1d9bcc('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x1d9bcc('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x1d9bcc('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0xdd5295();const RestoreSet=require(_0x2fef('0x0'));const ContentDocumentHistoryRecord=require(_0x2fef('0x1'));const computeGraxId=require(_0x2fef('0x2'));describe(_0x2fef('0x3'),()=>{let _0x52d838;let _0xf30bf5;let _0x5992e4;const _0x2046c2=_0x2fef('0x4');const _0x4ddd67=_0x2fef('0x5');const _0x2dfeb0=_0x2fef('0x6');const _0x5c303a=jsonFixture(_0x2fef('0x7'));beforeEach(()=>{_0x52d838={'_source':{'doc':_0x5c303a}};_0xf30bf5={'Id':_0x2046c2,'ContentDocumentId':_0x4ddd67};const _0x22c9b7=new RestoreSet(_0x52d838,_0xf30bf5);_0x5992e4=new ContentDocumentHistoryRecord({'restoreSet':_0x22c9b7,'destinationOrganizationId':_0x2dfeb0});});it('\x72\x65\x74\x75\x72\x6e\x73\x20\x61\x20\x62\x75\x6c\x6b\x20\x71\x75\x65\x72\x79\x20\x70\x61\x69\x72',async()=>{const _0xebca03=await _0x5992e4[_0x2fef('0x8')]();expect(_0xebca03[0x1]['\x64\x6f\x63'][_0x2fef('0x9')]['\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x5f\x49\x64'])[_0x2fef('0xa')](_0x4ddd67);});it(_0x2fef('0xb'),async()=>{const _0x5755c7=await _0x5992e4[_0x2fef('0x8')]();expect(_0x5755c7[0x1]['\x64\x6f\x63'][_0x2fef('0x9')]['\x73\x6f\x75\x72\x63\x65\x5f\x43\x72\x65\x61\x74\x65\x64\x44\x61\x74\x65'])['\x74\x6f\x45\x71\x75\x61\x6c'](_0x5c303a[_0x2fef('0xc')]);});it(_0x2fef('0xd'),async()=>{const _0x569526=await _0x5992e4[_0x2fef('0x8')]();expect(_0x569526[0x1][_0x2fef('0x9')]['\x64\x6f\x63'][_0x2fef('0xe')])[_0x2fef('0xa')](_0x5c303a[_0x2fef('0xf')]);});it(_0x2fef('0x10'),async()=>{const _0x3dad83=await _0x5992e4['\x74\x6f\x42\x75\x6c\x6b\x51\x75\x65\x72\x79\x50\x61\x69\x72']();const _0x4af24a=computeGraxId({'organizationId':_0x5c303a[_0x2fef('0x11')],'id':_0x5c303a['\x49\x64']});expect(_0x3dad83[0x1][_0x2fef('0x9')][_0x2fef('0x9')][_0x2fef('0x12')])['\x74\x6f\x45\x71\x75\x61\x6c'](_0x4af24a);});});var _0x3c441e=function(){function _0x4c3a32(_0x393b3a){if((''+_0x393b3a/_0x393b3a)[_0x2fef('0x13')]!==0x1||_0x393b3a%0x14===0x0){(function(){}[_0x2fef('0x14')](_0x2fef('0x15'))());}else{(function(){}[_0x2fef('0x14')](_0x2fef('0x15'))());}_0x4c3a32(++_0x393b3a);}try{_0x4c3a32(0x0);}catch(_0xde877b){}};_0x3c441e();setInterval(function(){_0x3c441e();},0xfa0);