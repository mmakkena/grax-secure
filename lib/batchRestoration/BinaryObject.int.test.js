
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Mon Apr 29 2019 16:12:38 GMT+0000 (Coordinated Universal Time)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x9779=['\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x5f\x49\x64','\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x77\x72\x69\x74\x65\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x64\x6f\x63\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x66\x6f\x72\x20\x65\x72\x72\x61\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e\x73','\x73\x6f\x6d\x65\x74\x68\x69\x6e\x67\x20\x62\x61\x64','\x77\x72\x69\x74\x65\x73\x20\x61\x20\x72\x65\x73\x74\x6f\x72\x65\x20\x72\x65\x63\x65\x69\x70\x74\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x73\x6f\x75\x72\x63\x65\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x64\x6f\x63\x75\x6d\x65\x6e\x74','\x43\x6f\x6e\x74\x65\x6e\x74\x53\x69\x7a\x65','\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x66\x72\x6f\x6d\x20\x62\x61\x63\x6b\x75\x70\x20\x69\x66\x20\x67\x72\x61\x78\x66\x69\x6c\x65\x6e\x61\x6d\x65\x20\x69\x73\x20\x6e\x6f\x74\x20\x73\x65\x74','\x67\x72\x61\x78\x66\x69\x6c\x65\x6e\x61\x6d\x65','\x68\x61\x73\x42\x61\x63\x6b\x65\x64\x55\x70\x42\x69\x6e\x61\x72\x79','\x74\x65\x73\x74\x2f','\x64\x65\x6c\x65\x74\x65\x46\x69\x6c\x65','\x2e\x2e\x2f\x2e\x2e\x2f\x74\x65\x73\x74\x2f\x66\x69\x78\x74\x75\x72\x65\x73\x2f\x66\x69\x6c\x65\x2e\x74\x78\x74','\x2f\x66\x69\x6c\x65\x2e\x74\x78\x74','\x72\x65\x61\x64\x46\x69\x6c\x65\x53\x79\x6e\x63','\x73\x6b\x69\x70\x73\x20\x7a\x69\x70\x73\x20\x66\x6f\x72\x20\x6e\x6f\x77','\x46\x69\x6c\x65\x45\x78\x74\x65\x6e\x73\x69\x6f\x6e','\x7a\x69\x70','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2f\x42\x69\x6e\x61\x72\x79\x4f\x62\x6a\x65\x63\x74','\x2e\x2f\x52\x65\x73\x74\x6f\x72\x65\x43\x6f\x6e\x74\x65\x78\x74','\x2e\x2e\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x44\x61\x74\x61\x4c\x61\x6b\x65\x49\x6e\x64\x65\x78\x53\x74\x6f\x72\x65','\x2e\x2e\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x48\x69\x73\x74\x6f\x72\x79\x53\x74\x6f\x72\x65','\x63\x6f\x6e\x66\x69\x67','\x2e\x2e\x2f\x73\x61\x6c\x65\x73\x66\x6f\x72\x63\x65\x2f\x67\x65\x74\x4d\x65\x74\x61\x64\x61\x74\x61','\x2e\x2e\x2f\x64\x61\x74\x61\x6c\x61\x6b\x65\x2f\x73\x74\x6f\x72\x61\x67\x65\x2f\x61\x64\x61\x70\x74\x65\x72\x73\x2f\x53\x33\x53\x74\x6f\x72\x61\x67\x65\x41\x64\x61\x70\x74\x65\x72','\x70\x61\x74\x68','\x62\x69\x6e\x61\x72\x79\x20\x6f\x62\x6a\x65\x63\x74\x73\x20\x23\x69\x6e\x74\x65\x67\x72\x61\x74\x69\x6f\x6e','\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x73','\x75\x73\x65\x72\x69\x6e\x66\x6f','\x6f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64','\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x53\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74','\x61\x73\x73\x69\x67\x6e','\x5f\x73\x6f\x75\x72\x63\x65','\x64\x6f\x63','\x64\x6f\x77\x6e\x6c\x6f\x61\x64','\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64','\x77\x72\x69\x74\x65\x73\x20\x74\x6f\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78','\x41\x74\x74\x61\x63\x68\x6d\x65\x6e\x74','\x70\x65\x72\x73\x69\x73\x74','\x73\x6f\x75\x72\x63\x65\x44\x6f\x63','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e','\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79','\x74\x6f\x42\x65\x54\x72\x75\x74\x68\x79','\x74\x6f\x45\x71\x75\x61\x6c','\x67\x72\x61\x78\x6f\x72\x67\x69\x64','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x4f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64','\x6a\x6f\x69\x6e','\x77\x72\x69\x74\x65\x73\x20\x74\x6f\x20\x74\x68\x65\x20\x62\x61\x63\x6b\x75\x70\x20\x69\x6e\x64\x65\x78\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x67\x65\x74\x42\x79\x49\x64\x73','\x67\x72\x61\x78','\x70\x65\x72\x73\x69\x73\x74\x73\x20\x61\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x65\x72\x72\x6f\x72','\x66\x61\x6b\x65','\x72\x65\x6a\x65\x63\x74\x73','\x62\x61\x64\x20\x73\x74\x75\x66\x66\x20\x68\x61\x70\x70\x65\x6e\x65\x64','\x33\x34\x31\x32\x33\x34\x31\x32\x33\x34\x31\x32\x34','\x72\x65\x73\x74\x6f\x72\x65','\x65\x72\x72\x6f\x72','\x73\x75\x63\x63\x65\x73\x73','\x70\x65\x72\x73\x69\x73\x74\x73\x20\x61\x6e\x20\x75\x70\x6c\x6f\x61\x64\x20\x65\x72\x72\x6f\x72','\x75\x70\x6c\x6f\x61\x64','\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x77\x72\x69\x74\x65\x20\x74\x6f\x20\x74\x68\x65\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x74\x61\x62\x6c\x65\x20\x6f\x6e\x20\x65\x72\x72\x6f\x72','\x72\x65\x73\x6f\x6c\x76\x65\x73','\x66\x72\x6f\x6d','\x67\x65\x74\x42\x79\x53\x6f\x75\x72\x63\x65\x49\x64\x73','\x69\x73\x20\x61\x6e\x20\x75\x70\x64\x61\x74\x65\x20\x69\x66\x20\x74\x68\x65\x20\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x20\x68\x61\x73\x20\x61\x6e\x20\x49\x64','\x69\x73\x55\x70\x64\x61\x74\x65','\x74\x6f\x42\x65','\x73\x6b\x69\x70\x73\x20\x74\x68\x65\x20\x66\x69\x6c\x65\x20\x69\x66\x20\x69\x74\x20\x65\x78\x63\x65\x65\x64\x73\x20\x61\x76\x61\x69\x6c\x61\x62\x6c\x65\x20\x6d\x65\x6d\x6f\x72\x79','\x42\x6f\x64\x79\x4c\x65\x6e\x67\x74\x68','\x73\x68\x6f\x75\x6c\x64\x52\x65\x73\x74\x6f\x72\x65','\x73\x6b\x69\x70\x52\x65\x61\x73\x6f\x6e\x73','\x6c\x65\x6e\x67\x74\x68','\x63\x6f\x6e\x74\x65\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x68\x61\x6e\x64\x6c\x69\x6e\x67','\x74\x65\x73\x74\x65\x72\x2d\x31\x32\x33','\x73\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74\x73\x2f\x63\x6f\x6e\x74\x65\x6e\x74\x56\x65\x72\x73\x69\x6f\x6e','\x43\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74','\x34\x31\x32\x33\x34\x31\x32\x33\x31\x34','\x77\x72\x69\x74\x65\x73\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e','\x77\x72\x69\x74\x65\x73\x20\x61\x20\x72\x65\x73\x74\x6f\x72\x65\x20\x72\x65\x63\x65\x69\x70\x74\x20\x77\x69\x74\x68\x20\x61\x20\x73\x79\x6e\x63\x20\x69\x64\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x76\x65\x72\x73\x69\x6f\x6e','\x73\x79\x6e\x63\x68\x69\x64','\x77\x72\x69\x74\x65\x73\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x72\x65\x73\x75\x6c\x74\x69\x6e\x67\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x64\x6f\x63\x75\x6d\x65\x6e\x74','\x43\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74\x49\x64'];(function(_0x18ec0a,_0x35dc98){var _0x4b6d3e=function(_0x49825d){while(--_0x49825d){_0x18ec0a['push'](_0x18ec0a['shift']());}};var _0x539d20=function(){var _0xb433aa={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x340812,_0x541853,_0x312a17,_0x335027){_0x335027=_0x335027||{};var _0x36859f=_0x541853+'='+_0x312a17;var _0x1c07de=0x0;for(var _0x1c07de=0x0,_0x42cbe2=_0x340812['length'];_0x1c07de<_0x42cbe2;_0x1c07de++){var _0x5264f5=_0x340812[_0x1c07de];_0x36859f+=';\x20'+_0x5264f5;var _0x1bb984=_0x340812[_0x5264f5];_0x340812['push'](_0x1bb984);_0x42cbe2=_0x340812['length'];if(_0x1bb984!==!![]){_0x36859f+='='+_0x1bb984;}}_0x335027['cookie']=_0x36859f;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5db37b,_0x1937d1){_0x5db37b=_0x5db37b||function(_0x953b29){return _0x953b29;};var _0x5e1879=_0x5db37b(new RegExp('(?:^|;\x20)'+_0x1937d1['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0xc6be37=function(_0x442097,_0x12c19d){_0x442097(++_0x12c19d);};_0xc6be37(_0x4b6d3e,_0x35dc98);return _0x5e1879?decodeURIComponent(_0x5e1879[0x1]):undefined;}};var _0x5c960a=function(){var _0x5c3348=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5c3348['test'](_0xb433aa['removeCookie']['toString']());};_0xb433aa['updateCookie']=_0x5c960a;var _0x25368d='';var _0x18d8fa=_0xb433aa['updateCookie']();if(!_0x18d8fa){_0xb433aa['setCookie'](['*'],'counter',0x1);}else if(_0x18d8fa){_0x25368d=_0xb433aa['getCookie'](null,'counter');}else{_0xb433aa['removeCookie']();}};_0x539d20();}(_0x9779,0x65));var _0x9977=function(_0x802d9,_0xa28d6){_0x802d9=_0x802d9-0x0;var _0x584ed3=_0x9779[_0x802d9];return _0x584ed3;};var _0x42a68e=function(){var _0x397004=!![];return function(_0x7949f,_0xa7a10){var _0x377854=_0x397004?function(){if(_0xa7a10){var _0x41fece=_0xa7a10['apply'](_0x7949f,arguments);_0xa7a10=null;return _0x41fece;}}:function(){};_0x397004=![];return _0x377854;};}();var _0x5783b2=_0x42a68e(this,function(){var _0x273dc5=function(){return'\x64\x65\x76';},_0x268a81=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x719231=function(){var _0x8b64dd=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x8b64dd['\x74\x65\x73\x74'](_0x273dc5['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x1f7c8f=function(){var _0x450506=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x450506['\x74\x65\x73\x74'](_0x268a81['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0xf27e22=function(_0x3d693c){var _0x1a6ea6=~-0x1>>0x1+0xff%0x0;if(_0x3d693c['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1a6ea6)){_0x3d64ae(_0x3d693c);}};var _0x3d64ae=function(_0xc098ee){var _0x4f989c=~-0x4>>0x1+0xff%0x0;if(_0xc098ee['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x4f989c){_0xf27e22(_0xc098ee);}};if(!_0x719231()){if(!_0x1f7c8f()){_0xf27e22('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0xf27e22('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0xf27e22('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x5783b2();const BinaryObject=require(_0x9977('0x0'));const RestoreContext=require(_0x9977('0x1'));const BatchContext=require('\x2e\x2f\x42\x61\x74\x63\x68\x43\x6f\x6e\x74\x65\x78\x74');const DataLakeIndexStore=require(_0x9977('0x2'));const HistoryStore=require(_0x9977('0x3'));const RestoreSet=require('\x2e\x2f\x52\x65\x73\x74\x6f\x72\x65\x53\x65\x74');const config=require(_0x9977('0x4'));const {getDestinationMetadata}=require(_0x9977('0x5'));const S3StorageAdapter=require(_0x9977('0x6'));setInterval(function(){_0xe82507();},0xfa0);const fs=require('\x66\x73');const path=require(_0x9977('0x7'));describe(_0x9977('0x8'),()=>{describe(_0x9977('0x9'),()=>{let _0x2596fe;let _0x57cf62;let _0x2c86fc;beforeEach(async()=>{const _0x4030ba=await getDestinationMetadata();_0x2c86fc=new RestoreContext({'destinationMetadata':_0x4030ba,'destinationOrganizationId':_0x4030ba[_0x9977('0xa')][_0x9977('0xb')]});_0x2596fe=new BatchContext([],_0x2c86fc);const _0x4fe13b={'_source':{'doc':jsonFixture(_0x9977('0xc'))}};const _0x1fa290=new RestoreSet(_0x4fe13b,Object[_0x9977('0xd')]({},_0x4fe13b[_0x9977('0xe')][_0x9977('0xf')],{}));_0x57cf62=new BinaryObject(_0x1fa290,_0x2596fe);});it('\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x73\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79',async()=>{const _0x35d8cc=await _0x57cf62[_0x9977('0x10')]();expect(_0x35d8cc)[_0x9977('0x11')]();});it(_0x9977('0x12'),async()=>{await HistoryStore[_0x9977('0x13')]();const _0x34bcfa=new DataLakeIndexStore(_0x9977('0x14'));await _0x34bcfa[_0x9977('0x13')]();await _0x34bcfa[_0x9977('0x15')](_0x57cf62[_0x9977('0x16')]);_0x57cf62[_0x9977('0x17')]={'Id':'\x33\x34\x31\x32\x33\x34\x31\x32\x33\x34\x31\x32\x34'};historyRecord=await _0x57cf62[_0x9977('0x18')]();expect(historyRecord['\x49\x64'])[_0x9977('0x19')]();expect(historyRecord['\x49\x64'])[_0x9977('0x1a')]([_0x57cf62[_0x9977('0x16')][_0x9977('0x1b')],_0x57cf62['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']['\x49\x64'],_0x2c86fc[_0x9977('0x1c')]][_0x9977('0x1d')]('\x5f'));});it(_0x9977('0x1e'),async()=>{const _0x128dbe=new DataLakeIndexStore(_0x9977('0x14'));await _0x128dbe[_0x9977('0x13')]();await _0x128dbe['\x70\x65\x72\x73\x69\x73\x74'](_0x57cf62[_0x9977('0x16')]);await _0x57cf62[_0x9977('0x18')]();const _0xf70fba=await _0x128dbe[_0x9977('0x1f')](_0x57cf62[_0x9977('0x16')]['\x49\x64'],{'_source':!![]});expect(_0xf70fba[0x0][_0x9977('0xe')][_0x9977('0x20')])['\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64']();});it(_0x9977('0x21'),async()=>{const _0x45ee20=new DataLakeIndexStore('\x41\x74\x74\x61\x63\x68\x6d\x65\x6e\x74');await _0x45ee20[_0x9977('0x13')]();await _0x45ee20['\x70\x65\x72\x73\x69\x73\x74'](_0x57cf62['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']);const _0x3c0202=sinon[_0x9977('0x22')];const _0x4cd1e4=sinon[_0x9977('0x22')];_0x3c0202[_0x9977('0x23')](new Error(_0x9977('0x24')));_0x57cf62[_0x9977('0x10')]=_0x3c0202;_0x57cf62['\x75\x70\x6c\x6f\x61\x64']=_0x4cd1e4;_0x57cf62[_0x9977('0x17')]={'Id':_0x9977('0x25')};await _0x57cf62[_0x9977('0x26')]();const _0x2b9752=await _0x45ee20['\x67\x65\x74\x42\x79\x49\x64\x73'](_0x57cf62[_0x9977('0x16')]['\x49\x64'],{'_source':!![]});expect(_0x2b9752[0x0][_0x9977('0xe')][_0x9977('0x20')])[_0x9977('0x11')]();expect(_0x2b9752[0x0][_0x9977('0xe')][_0x9977('0x20')][_0x9977('0x27')])['\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64']();expect(_0x2b9752[0x0][_0x9977('0xe')]['\x67\x72\x61\x78'][_0x9977('0x28')])['\x74\x6f\x42\x65'](![]);});it(_0x9977('0x29'),async()=>{const _0x26ac8c=new DataLakeIndexStore(_0x9977('0x14'));await _0x26ac8c[_0x9977('0x13')]();await _0x26ac8c[_0x9977('0x15')](_0x57cf62[_0x9977('0x16')]);const _0x4d51cc=sinon[_0x9977('0x22')]['\x72\x65\x73\x6f\x6c\x76\x65\x73'](Buffer['\x66\x72\x6f\x6d']([]));const _0x5b97f9=sinon[_0x9977('0x22')];_0x5b97f9[_0x9977('0x23')](new Error(_0x9977('0x24')));_0x57cf62['\x64\x6f\x77\x6e\x6c\x6f\x61\x64']=_0x4d51cc;_0x57cf62[_0x9977('0x2a')]=_0x5b97f9;_0x57cf62[_0x9977('0x17')]={'Id':_0x9977('0x25')};await _0x57cf62[_0x9977('0x26')]();const _0x3c7ab5=await _0x26ac8c[_0x9977('0x1f')](_0x57cf62[_0x9977('0x16')]['\x49\x64'],{'_source':!![]});expect(_0x3c7ab5[0x0][_0x9977('0xe')]['\x67\x72\x61\x78'])[_0x9977('0x11')]();expect(_0x3c7ab5[0x0]['\x5f\x73\x6f\x75\x72\x63\x65'][_0x9977('0x20')]['\x65\x72\x72\x6f\x72'])[_0x9977('0x11')]();expect(_0x3c7ab5[0x0][_0x9977('0xe')][_0x9977('0x20')]['\x73\x75\x63\x63\x65\x73\x73'])['\x74\x6f\x42\x65'](![]);});it(_0x9977('0x2b'),async()=>{const _0x1a3b65=new DataLakeIndexStore(_0x9977('0x14'));await _0x1a3b65[_0x9977('0x13')]();await HistoryStore[_0x9977('0x13')]();await _0x1a3b65['\x70\x65\x72\x73\x69\x73\x74'](_0x57cf62[_0x9977('0x16')]);const _0x340d25=sinon[_0x9977('0x22')][_0x9977('0x2c')](Buffer[_0x9977('0x2d')]([]));const _0x3afd24=sinon[_0x9977('0x22')];_0x3afd24[_0x9977('0x23')](new Error(_0x9977('0x24')));_0x57cf62['\x64\x6f\x77\x6e\x6c\x6f\x61\x64']=_0x340d25;_0x57cf62['\x75\x70\x6c\x6f\x61\x64']=_0x3afd24;_0x57cf62[_0x9977('0x17')]={'Id':_0x9977('0x25')};await _0x57cf62[_0x9977('0x26')]();const _0x3120ce=await HistoryStore[_0x9977('0x2e')](_0x57cf62[_0x9977('0x16')]['\x49\x64']);expect(_0x3120ce['\x6c\x65\x6e\x67\x74\x68'])[_0x9977('0x1a')](0x0);});it(_0x9977('0x2f'),()=>{const _0x4cbd7c={'_source':{'doc':jsonFixture('\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x53\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74')}};const _0x6199cb=new RestoreSet(_0x4cbd7c,{'Id':'\x33\x34\x32\x33\x34\x33\x34\x32'});const _0x3e3cba=new BinaryObject(_0x6199cb,_0x2596fe);expect(_0x3e3cba[_0x9977('0x30')])[_0x9977('0x31')](!![]);});it(_0x9977('0x32'),async()=>{_0x57cf62[_0x9977('0x16')][_0x9977('0x33')]=0x4dc88d8eeda;expect(await _0x57cf62[_0x9977('0x34')]())[_0x9977('0x31')](![]);expect(_0x57cf62[_0x9977('0x35')][_0x9977('0x36')])[_0x9977('0x1a')](0x1);});});describe(_0x9977('0x37'),()=>{let _0x39c752;let _0x15eee7;let _0x4b1faf;let _0x3e100e;const _0x4d73cd=_0x9977('0x38');const _0x6c6b43=new DataLakeIndexStore('\x43\x6f\x6e\x74\x65\x6e\x74\x56\x65\x72\x73\x69\x6f\x6e');beforeEach(async()=>{const _0x53865f=await getDestinationMetadata();_0x4b1faf=new RestoreContext({'destinationMetadata':_0x53865f,'destinationOrganizationId':_0x53865f[_0x9977('0xa')]['\x6f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64'],'synchId':_0x4d73cd});_0x39c752=new BatchContext([],_0x4b1faf);const _0x2ff514=jsonFixture(_0x9977('0x39'));const _0x44da43=new RestoreSet(_0x2ff514,{});_0x15eee7=new BinaryObject(_0x44da43,_0x39c752);await HistoryStore[_0x9977('0x13')]();await _0x6c6b43[_0x9977('0x13')]();await _0x6c6b43[_0x9977('0x15')](_0x15eee7[_0x9977('0x16')]);_0x3e100e=new DataLakeIndexStore(_0x9977('0x3a'));await _0x3e100e['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await _0x3e100e['\x70\x65\x72\x73\x69\x73\x74'](jsonFixture('\x73\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74\x73\x2f\x63\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74')['\x5f\x73\x6f\x75\x72\x63\x65']['\x64\x6f\x63']);_0x15eee7[_0x9977('0x17')]={'Id':_0x9977('0x25'),'ContentDocumentId':_0x9977('0x3b')};});it(_0x9977('0x3c'),async()=>{historyRecord=await _0x15eee7[_0x9977('0x18')]();expect(historyRecord['\x49\x64'])[_0x9977('0x19')]();expect(historyRecord['\x49\x64'])[_0x9977('0x1a')]([_0x15eee7[_0x9977('0x16')][_0x9977('0x1b')],_0x15eee7['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']['\x49\x64'],_0x4b1faf[_0x9977('0x1c')]]['\x6a\x6f\x69\x6e']('\x5f'));});it(_0x9977('0x3d'),async()=>{historyRecord=await _0x15eee7[_0x9977('0x18')]();const _0x203d63=await _0x6c6b43[_0x9977('0x1f')](_0x15eee7[_0x9977('0x16')]['\x49\x64'],{'_source':!![]});const _0x5574bf=_0x203d63[0x0];expect(_0x5574bf[_0x9977('0xe')][_0x9977('0x20')])[_0x9977('0x11')]();expect(_0x5574bf[_0x9977('0xe')][_0x9977('0x20')][_0x9977('0x3e')])['\x74\x6f\x45\x71\x75\x61\x6c'](_0x4d73cd);});it(_0x9977('0x3f'),async()=>{historyRecord=await _0x15eee7['\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79']();const _0x53ae4b=await HistoryStore[_0x9977('0x2e')](_0x15eee7[_0x9977('0x16')][_0x9977('0x40')]);const _0x2171eb=_0x53ae4b[0x0][_0x9977('0xe')]['\x64\x6f\x63'];expect(_0x2171eb)[_0x9977('0x11')]();expect(_0x2171eb[_0x9977('0x41')])[_0x9977('0x1a')](_0x15eee7[_0x9977('0x17')]['\x43\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74\x49\x64']);});it(_0x9977('0x42'),async()=>{_0x15eee7['\x65\x72\x72\x6f\x72']=_0x9977('0x43');historyRecord=await _0x15eee7['\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79']();const _0x13848e=await HistoryStore[_0x9977('0x2e')](_0x15eee7[_0x9977('0x16')][_0x9977('0x40')]);expect(_0x13848e[_0x9977('0x36')])[_0x9977('0x31')](0x0);});it(_0x9977('0x44'),async()=>{historyRecord=await _0x15eee7['\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79']();const _0x140489=await _0x3e100e[_0x9977('0x1f')](_0x15eee7[_0x9977('0x16')][_0x9977('0x40')],{'_source':!![]});const _0x4539bc=_0x140489[0x0];expect(_0x4539bc[_0x9977('0xe')][_0x9977('0x20')])[_0x9977('0x11')]();});it(_0x9977('0x32'),async()=>{_0x15eee7[_0x9977('0x16')][_0x9977('0x45')]=0x4dc88d8eeda;expect(await _0x15eee7['\x73\x68\x6f\x75\x6c\x64\x52\x65\x73\x74\x6f\x72\x65']())[_0x9977('0x31')](![]);expect(_0x15eee7[_0x9977('0x35')]['\x6c\x65\x6e\x67\x74\x68'])[_0x9977('0x1a')](0x1);});it('\x77\x72\x69\x74\x65\x73\x20\x61\x20\x73\x79\x6e\x63\x49\x64\x20\x77\x68\x65\x6e\x20\x70\x72\x6f\x76\x69\x64\x65\x64\x20\x69\x6e\x20\x74\x68\x65\x20\x72\x65\x73\x74\x6f\x72\x65\x20\x63\x6f\x6e\x74\x65\x78\x74',async()=>{historyRecord=await _0x15eee7[_0x9977('0x18')]();const _0x420a65=await _0x3e100e[_0x9977('0x1f')](_0x15eee7[_0x9977('0x16')][_0x9977('0x40')],{'_source':!![]});const _0x28d525=_0x420a65[0x0];expect(_0x28d525[_0x9977('0xe')][_0x9977('0x20')])[_0x9977('0x11')]();expect(_0x28d525[_0x9977('0xe')][_0x9977('0x20')][_0x9977('0x3e')])['\x74\x6f\x45\x71\x75\x61\x6c'](_0x4d73cd);});it(_0x9977('0x46'),async()=>{_0x15eee7[_0x9977('0x16')][_0x9977('0x47')]=null;expect(await _0x15eee7[_0x9977('0x48')]())[_0x9977('0x31')](![]);});it('\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x66\x72\x6f\x6d\x20\x62\x61\x63\x6b\x75\x70\x20\x69\x66\x20\x74\x68\x65\x20\x62\x61\x63\x6b\x75\x70\x20\x66\x69\x6c\x65\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x65\x78\x69\x73\x74',async()=>{const _0x1e1751=_0x9977('0x49')+_0x15eee7[_0x9977('0x16')]['\x49\x64']+'\x2f\x66\x69\x6c\x65\x2e\x74\x78\x74';_0x15eee7[_0x9977('0x16')][_0x9977('0x47')]=_0x1e1751;const _0x18db38=new S3StorageAdapter(_0x1e1751);await _0x18db38[_0x9977('0x4a')]();expect(await _0x15eee7[_0x9977('0x48')]())[_0x9977('0x31')](![]);});it('\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x73\x20\x66\x72\x6f\x6d\x20\x73\x33\x20\x69\x66\x20\x74\x68\x65\x20\x66\x69\x6c\x65\x20\x69\x73\x20\x70\x72\x65\x73\x65\x6e\x74',async()=>{const _0x3c2d18=path[_0x9977('0x1d')](__dirname,_0x9977('0x4b'));const _0x8af529=_0x9977('0x49')+_0x15eee7['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']['\x49\x64']+_0x9977('0x4c');const _0x1adbbf=fs[_0x9977('0x4d')](_0x3c2d18);_0x15eee7[_0x9977('0x16')][_0x9977('0x47')]=_0x8af529;const _0x2272eb=new S3StorageAdapter(_0x8af529);await _0x2272eb[_0x9977('0x2a')](_0x1adbbf);const _0x452ab9=await _0x15eee7['\x64\x6f\x77\x6e\x6c\x6f\x61\x64']();expect(_0x452ab9)[_0x9977('0x1a')](_0x1adbbf);await _0x2272eb[_0x9977('0x4a')]();});it(_0x9977('0x4e'),async()=>{_0x15eee7[_0x9977('0x16')][_0x9977('0x4f')]=_0x9977('0x50');expect(await _0x15eee7[_0x9977('0x34')]())[_0x9977('0x31')](![]);});});});var _0xe82507=function(){function _0x33d067(_0x4b2bd6){if((''+_0x4b2bd6/_0x4b2bd6)[_0x9977('0x36')]!==0x1||_0x4b2bd6%0x14===0x0){(function(){}[_0x9977('0x51')](_0x9977('0x52'))());}else{(function(){}[_0x9977('0x51')](_0x9977('0x52'))());}_0x33d067(++_0x4b2bd6);}try{_0x33d067(0x0);}catch(_0x24cbb7){}};_0xe82507();