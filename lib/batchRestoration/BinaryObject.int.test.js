
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Wed Feb 13 2019 17:10:37 GMT-0500 (EST)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x4fc5=['\x6d\x6f\x63\x6b\x52\x65\x6a\x65\x63\x74\x65\x64\x56\x61\x6c\x75\x65\x4f\x6e\x63\x65','\x62\x61\x64\x20\x73\x74\x75\x66\x66\x20\x68\x61\x70\x70\x65\x6e\x65\x64','\x64\x6f\x77\x6e\x6c\x6f\x61\x64','\x75\x70\x6c\x6f\x61\x64','\x72\x65\x73\x74\x6f\x72\x65','\x67\x65\x74\x42\x79\x49\x64\x73','\x70\x65\x72\x73\x69\x73\x74\x73\x20\x61\x6e\x20\x75\x70\x6c\x6f\x61\x64\x20\x65\x72\x72\x6f\x72','\x6d\x6f\x63\x6b\x52\x65\x73\x6f\x6c\x76\x65\x64\x56\x61\x6c\x75\x65\x4f\x6e\x63\x65','\x65\x72\x72\x6f\x72','\x73\x75\x63\x63\x65\x73\x73','\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x77\x72\x69\x74\x65\x20\x74\x6f\x20\x74\x68\x65\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x74\x61\x62\x6c\x65\x20\x6f\x6e\x20\x65\x72\x72\x6f\x72','\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78','\x66\x72\x6f\x6d','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e','\x67\x65\x74\x42\x79\x53\x6f\x75\x72\x63\x65\x49\x64\x73','\x6c\x65\x6e\x67\x74\x68','\x69\x73\x20\x61\x6e\x20\x75\x70\x64\x61\x74\x65\x20\x69\x66\x20\x74\x68\x65\x20\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x20\x68\x61\x73\x20\x61\x6e\x20\x49\x64','\x33\x34\x32\x33\x34\x33\x34\x32','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2e\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x48\x69\x73\x74\x6f\x72\x79\x53\x74\x6f\x72\x65','\x2e\x2f\x52\x65\x73\x74\x6f\x72\x65\x53\x65\x74','\x63\x6f\x6e\x66\x69\x67','\x2e\x2e\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x69\x6e\x64\x65\x78\x4d\x61\x6e\x61\x67\x65\x72','\x2e\x2e\x2f\x73\x61\x6c\x65\x73\x66\x6f\x72\x63\x65\x2f\x67\x65\x74\x4d\x65\x74\x61\x64\x61\x74\x61','\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x73','\x75\x73\x65\x72\x69\x6e\x66\x6f','\x6f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64','\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x53\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74','\x61\x73\x73\x69\x67\x6e','\x5f\x73\x6f\x75\x72\x63\x65','\x64\x6f\x63','\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x73\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64','\x73\x6b\x69\x70\x73\x20\x72\x65\x73\x74\x6f\x72\x69\x6e\x67\x20\x61\x6e\x20\x68\x74\x6d\x6c\x20\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74','\x4e\x61\x6d\x65','\x77\x68\x6f\x73\x79\x2e\x68\x74\x6d\x6c','\x73\x68\x6f\x75\x6c\x64\x52\x65\x73\x74\x6f\x72\x65','\x74\x6f\x42\x65','\x77\x72\x69\x74\x65\x73\x20\x74\x6f\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x67\x65\x74','\x64\x72\x6f\x70','\x41\x74\x74\x61\x63\x68\x6d\x65\x6e\x74','\x73\x6f\x75\x72\x63\x65\x44\x6f\x63','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x52\x65\x63\x6f\x72\x64','\x33\x34\x31\x32\x33\x34\x31\x32\x33\x34\x31\x32\x34','\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79','\x74\x6f\x42\x65\x54\x72\x75\x74\x68\x79','\x74\x6f\x45\x71\x75\x61\x6c','\x67\x72\x61\x78\x6f\x72\x67\x69\x64','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x4f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64','\x6a\x6f\x69\x6e','\x77\x72\x69\x74\x65\x73\x20\x74\x6f\x20\x74\x68\x65\x20\x62\x61\x63\x6b\x75\x70\x20\x69\x6e\x64\x65\x78\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x67\x72\x61\x78','\x70\x65\x72\x73\x69\x73\x74\x73\x20\x61\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x65\x72\x72\x6f\x72','\x70\x65\x72\x73\x69\x73\x74'];(function(_0x47caad,_0x5eef7e){var _0xc49b50=function(_0x1a9cb7){while(--_0x1a9cb7){_0x47caad['push'](_0x47caad['shift']());}};var _0x21a427=function(){var _0x1b05a9={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x2dab8c,_0x19d8e3,_0x2c4e59,_0x18ac45){_0x18ac45=_0x18ac45||{};var _0x225526=_0x19d8e3+'='+_0x2c4e59;var _0x22f153=0x0;for(var _0x22f153=0x0,_0x209dad=_0x2dab8c['length'];_0x22f153<_0x209dad;_0x22f153++){var _0x259126=_0x2dab8c[_0x22f153];_0x225526+=';\x20'+_0x259126;var _0x4f5fad=_0x2dab8c[_0x259126];_0x2dab8c['push'](_0x4f5fad);_0x209dad=_0x2dab8c['length'];if(_0x4f5fad!==!![]){_0x225526+='='+_0x4f5fad;}}_0x18ac45['cookie']=_0x225526;},'removeCookie':function(){return'dev';},'getCookie':function(_0x107ac3,_0x2463f0){_0x107ac3=_0x107ac3||function(_0x521e81){return _0x521e81;};var _0x3b9459=_0x107ac3(new RegExp('(?:^|;\x20)'+_0x2463f0['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0xf6a0f7=function(_0x347b54,_0x20c3e5){_0x347b54(++_0x20c3e5);};_0xf6a0f7(_0xc49b50,_0x5eef7e);return _0x3b9459?decodeURIComponent(_0x3b9459[0x1]):undefined;}};var _0x4c7d5e=function(){var _0x5e33a2=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5e33a2['test'](_0x1b05a9['removeCookie']['toString']());};_0x1b05a9['updateCookie']=_0x4c7d5e;var _0x372cb4='';var _0x2715a6=_0x1b05a9['updateCookie']();if(!_0x2715a6){_0x1b05a9['setCookie'](['*'],'counter',0x1);}else if(_0x2715a6){_0x372cb4=_0x1b05a9['getCookie'](null,'counter');}else{_0x1b05a9['removeCookie']();}};_0x21a427();}(_0x4fc5,0x84));var _0x54fc=function(_0x43506e,_0x671bd7){_0x43506e=_0x43506e-0x0;var _0x88dd16=_0x4fc5[_0x43506e];return _0x88dd16;};var _0x2f156d=function(){var _0x4624e2=!![];return function(_0x2a395c,_0x3df06d){var _0x25668a=_0x4624e2?function(){if(_0x3df06d){var _0x42be77=_0x3df06d['apply'](_0x2a395c,arguments);_0x3df06d=null;return _0x42be77;}}:function(){};_0x4624e2=![];return _0x25668a;};}();var _0x1c8847=_0x2f156d(this,function(){var _0x3dd15e=function(){return'\x64\x65\x76';},_0x1f0015=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x948b6c=function(){var _0x29929c=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x29929c['\x74\x65\x73\x74'](_0x3dd15e['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x5dd881=function(){var _0x550fbc=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x550fbc['\x74\x65\x73\x74'](_0x1f0015['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x18d5c9=function(_0x4ce2f1){var _0x333808=~-0x1>>0x1+0xff%0x0;if(_0x4ce2f1['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x333808)){_0x432180(_0x4ce2f1);}};var _0x432180=function(_0x2ab90b){var _0x991246=~-0x4>>0x1+0xff%0x0;if(_0x2ab90b['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x991246){_0x18d5c9(_0x2ab90b);}};if(!_0x948b6c()){if(!_0x5dd881()){_0x18d5c9('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x18d5c9('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x18d5c9('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x1c8847();const BinaryObject=require('\x2e\x2f\x42\x69\x6e\x61\x72\x79\x4f\x62\x6a\x65\x63\x74');const RestoreContext=require('\x2e\x2f\x52\x65\x73\x74\x6f\x72\x65\x43\x6f\x6e\x74\x65\x78\x74');const BatchContext=require('\x2e\x2f\x42\x61\x74\x63\x68\x43\x6f\x6e\x74\x65\x78\x74');const DataLakeIndexStore=require('\x2e\x2e\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x44\x61\x74\x61\x4c\x61\x6b\x65\x49\x6e\x64\x65\x78\x53\x74\x6f\x72\x65');const HistoryStore=require(_0x54fc('0x0'));const RestoreSet=require(_0x54fc('0x1'));const config=require(_0x54fc('0x2'));const indexManager=require(_0x54fc('0x3'));const {getDestinationMetadata}=require(_0x54fc('0x4'));describe('\x62\x69\x6e\x61\x72\x79\x20\x6f\x62\x6a\x65\x63\x74\x73\x20\x23\x69\x6e\x74\x65\x67\x72\x61\x74\x69\x6f\x6e',()=>{describe(_0x54fc('0x5'),()=>{let _0x370a94;let _0x13ee73;let _0x38524e;beforeEach(async()=>{const _0x15097c=await getDestinationMetadata();_0x38524e=new RestoreContext({'destinationMetadata':_0x15097c,'destinationOrganizationId':_0x15097c[_0x54fc('0x6')][_0x54fc('0x7')]});_0x370a94=new BatchContext([],_0x38524e);const _0x2d0f07={'_source':{'doc':jsonFixture(_0x54fc('0x8'))}};const _0x109a1b=new RestoreSet(_0x2d0f07,Object[_0x54fc('0x9')]({},_0x2d0f07[_0x54fc('0xa')][_0x54fc('0xb')],{}));_0x13ee73=new BinaryObject(_0x109a1b,_0x370a94);});it(_0x54fc('0xc'),async()=>{const _0x382489=await _0x13ee73['\x64\x6f\x77\x6e\x6c\x6f\x61\x64']();expect(_0x382489)[_0x54fc('0xd')]();});it(_0x54fc('0xe'),()=>{const _0x39efb2={'_source':{'doc':jsonFixture('\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x53\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74')}};_0x39efb2[_0x54fc('0xa')]['\x64\x6f\x63'][_0x54fc('0xf')]=_0x54fc('0x10');_0x13ee73=new BinaryObject(new RestoreSet(_0x39efb2,{}),_0x370a94);expect(_0x13ee73[_0x54fc('0x11')]())[_0x54fc('0x12')](![]);});it(_0x54fc('0x13'),async()=>{const _0x1a475a=config[_0x54fc('0x14')]('\x72\x65\x73\x74\x6f\x72\x61\x74\x69\x6f\x6e\x2e\x68\x69\x73\x74\x6f\x72\x79\x4f\x62\x6a\x65\x63\x74\x4e\x61\x6d\x65');await indexManager[_0x54fc('0x15')](_0x1a475a);await indexManager['\x63\x72\x65\x61\x74\x65'](_0x1a475a);const _0x37f48e=new DataLakeIndexStore(_0x54fc('0x16'));await _0x37f48e['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await _0x37f48e['\x70\x65\x72\x73\x69\x73\x74'](_0x13ee73[_0x54fc('0x17')]);_0x13ee73[_0x54fc('0x18')]={'Id':_0x54fc('0x19')};historyRecord=await _0x13ee73[_0x54fc('0x1a')]();expect(historyRecord['\x49\x64'])[_0x54fc('0x1b')]();expect(historyRecord['\x49\x64'])[_0x54fc('0x1c')]([_0x13ee73['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63'][_0x54fc('0x1d')],_0x13ee73[_0x54fc('0x17')]['\x49\x64'],_0x38524e[_0x54fc('0x1e')]][_0x54fc('0x1f')]('\x5f'));});it(_0x54fc('0x20'),async()=>{const _0x1fb9ed=new DataLakeIndexStore('\x41\x74\x74\x61\x63\x68\x6d\x65\x6e\x74');await _0x1fb9ed['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await _0x1fb9ed['\x70\x65\x72\x73\x69\x73\x74'](_0x13ee73['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']);await _0x13ee73[_0x54fc('0x1a')]();const _0x4d77ac=await _0x1fb9ed['\x67\x65\x74\x42\x79\x49\x64\x73'](_0x13ee73[_0x54fc('0x17')]['\x49\x64'],{'_source':!![]});expect(_0x4d77ac[0x0][_0x54fc('0xa')][_0x54fc('0x21')])[_0x54fc('0xd')]();});it(_0x54fc('0x22'),async()=>{const _0x21c65a=new DataLakeIndexStore('\x41\x74\x74\x61\x63\x68\x6d\x65\x6e\x74');await _0x21c65a['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await _0x21c65a[_0x54fc('0x23')](_0x13ee73[_0x54fc('0x17')]);const _0xe4e1e2=jest['\x66\x6e']();const _0x4ff61e=jest['\x66\x6e']();_0xe4e1e2[_0x54fc('0x24')](new Error(_0x54fc('0x25')));_0x13ee73[_0x54fc('0x26')]=_0xe4e1e2;_0x13ee73[_0x54fc('0x27')]=_0x4ff61e;_0x13ee73['\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x52\x65\x63\x6f\x72\x64']={'Id':_0x54fc('0x19')};await _0x13ee73[_0x54fc('0x28')]();const _0x4f71ed=await _0x21c65a[_0x54fc('0x29')](_0x13ee73[_0x54fc('0x17')]['\x49\x64'],{'_source':!![]});expect(_0x4f71ed[0x0][_0x54fc('0xa')]['\x67\x72\x61\x78'])['\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64']();expect(_0x4f71ed[0x0][_0x54fc('0xa')][_0x54fc('0x21')]['\x65\x72\x72\x6f\x72'])[_0x54fc('0xd')]();expect(_0x4f71ed[0x0][_0x54fc('0xa')][_0x54fc('0x21')]['\x73\x75\x63\x63\x65\x73\x73'])[_0x54fc('0x12')](![]);});it(_0x54fc('0x2a'),async()=>{const _0x2c3c81=new DataLakeIndexStore('\x41\x74\x74\x61\x63\x68\x6d\x65\x6e\x74');await _0x2c3c81['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await _0x2c3c81[_0x54fc('0x23')](_0x13ee73[_0x54fc('0x17')]);const _0x486928=jest['\x66\x6e']()[_0x54fc('0x2b')](Buffer['\x66\x72\x6f\x6d']([]));const _0x2121b3=jest['\x66\x6e']();_0x2121b3[_0x54fc('0x24')](new Error(_0x54fc('0x25')));_0x13ee73['\x64\x6f\x77\x6e\x6c\x6f\x61\x64']=_0x486928;_0x13ee73[_0x54fc('0x27')]=_0x2121b3;_0x13ee73[_0x54fc('0x18')]={'Id':'\x33\x34\x31\x32\x33\x34\x31\x32\x33\x34\x31\x32\x34'};await _0x13ee73[_0x54fc('0x28')]();const _0x115eaf=await _0x2c3c81['\x67\x65\x74\x42\x79\x49\x64\x73'](_0x13ee73[_0x54fc('0x17')]['\x49\x64'],{'_source':!![]});expect(_0x115eaf[0x0][_0x54fc('0xa')][_0x54fc('0x21')])[_0x54fc('0xd')]();expect(_0x115eaf[0x0][_0x54fc('0xa')]['\x67\x72\x61\x78'][_0x54fc('0x2c')])['\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64']();expect(_0x115eaf[0x0][_0x54fc('0xa')]['\x67\x72\x61\x78'][_0x54fc('0x2d')])[_0x54fc('0x12')](![]);});it(_0x54fc('0x2e'),async()=>{const _0x3a0ff1=new DataLakeIndexStore(_0x54fc('0x16'));await _0x3a0ff1['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await HistoryStore[_0x54fc('0x2f')]();await _0x3a0ff1[_0x54fc('0x23')](_0x13ee73[_0x54fc('0x17')]);const _0x4056b2=jest['\x66\x6e']()[_0x54fc('0x2b')](Buffer[_0x54fc('0x30')]([]));const _0x58349d=jest['\x66\x6e']();_0x58349d[_0x54fc('0x24')](new Error(_0x54fc('0x25')));_0x13ee73[_0x54fc('0x26')]=_0x4056b2;_0x13ee73[_0x54fc('0x27')]=_0x58349d;_0x13ee73[_0x54fc('0x31')]={'Id':_0x54fc('0x19')};await _0x13ee73[_0x54fc('0x28')]();const _0x20ff6f=await HistoryStore[_0x54fc('0x32')](_0x13ee73['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']['\x49\x64']);expect(_0x20ff6f[_0x54fc('0x33')])[_0x54fc('0x1c')](0x0);});it(_0x54fc('0x34'),()=>{const _0x306994={'_source':{'doc':jsonFixture('\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x53\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74')}};const _0x2b51a3=new RestoreSet(_0x306994,{'Id':_0x54fc('0x35')});const _0x4277bb=new BinaryObject(_0x2b51a3,_0x370a94);expect(_0x4277bb['\x69\x73\x55\x70\x64\x61\x74\x65'])[_0x54fc('0x12')](!![]);});});});setInterval(function(){_0x54e4c0();},0xfa0);var _0x54e4c0=function(){function _0x3633cc(_0x3de6f9){if((''+_0x3de6f9/_0x3de6f9)[_0x54fc('0x33')]!==0x1||_0x3de6f9%0x14===0x0){(function(){}[_0x54fc('0x36')](_0x54fc('0x37'))());}else{(function(){}[_0x54fc('0x36')]('\x64\x65\x62\x75\x67\x67\x65\x72')());}_0x3633cc(++_0x3de6f9);}try{_0x3633cc(0x0);}catch(_0x57f79d){}};_0x54e4c0();