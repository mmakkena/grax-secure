
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Wed Apr 03 2019 21:26:06 GMT+0000 (Coordinated Universal Time)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0xd3c0=['\x73\x79\x6e\x63\x68\x69\x64','\x77\x72\x69\x74\x65\x73\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x72\x65\x73\x75\x6c\x74\x69\x6e\x67\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x64\x6f\x63\x75\x6d\x65\x6e\x74','\x43\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74\x49\x64','\x64\x6f\x63','\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x77\x72\x69\x74\x65\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x64\x6f\x63\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x66\x6f\x72\x20\x65\x72\x72\x61\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e\x73','\x73\x6f\x6d\x65\x74\x68\x69\x6e\x67\x20\x62\x61\x64','\x77\x72\x69\x74\x65\x73\x20\x61\x20\x72\x65\x73\x74\x6f\x72\x65\x20\x72\x65\x63\x65\x69\x70\x74\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x73\x6f\x75\x72\x63\x65\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x64\x6f\x63\x75\x6d\x65\x6e\x74','\x73\x6b\x69\x70\x73\x20\x74\x68\x65\x20\x66\x69\x6c\x65\x20\x69\x66\x20\x69\x74\x20\x65\x78\x63\x65\x65\x64\x73\x20\x61\x76\x61\x69\x6c\x61\x62\x6c\x65\x20\x6d\x65\x6d\x6f\x72\x79','\x77\x72\x69\x74\x65\x73\x20\x61\x20\x73\x79\x6e\x63\x49\x64\x20\x77\x68\x65\x6e\x20\x70\x72\x6f\x76\x69\x64\x65\x64\x20\x69\x6e\x20\x74\x68\x65\x20\x72\x65\x73\x74\x6f\x72\x65\x20\x63\x6f\x6e\x74\x65\x78\x74','\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x66\x72\x6f\x6d\x20\x62\x61\x63\x6b\x75\x70\x20\x69\x66\x20\x67\x72\x61\x78\x66\x69\x6c\x65\x6e\x61\x6d\x65\x20\x69\x73\x20\x6e\x6f\x74\x20\x73\x65\x74','\x67\x72\x61\x78\x66\x69\x6c\x65\x6e\x61\x6d\x65','\x68\x61\x73\x42\x61\x63\x6b\x65\x64\x55\x70\x42\x69\x6e\x61\x72\x79','\x74\x65\x73\x74\x2f','\x2f\x66\x69\x6c\x65\x2e\x74\x78\x74','\x64\x65\x6c\x65\x74\x65\x46\x69\x6c\x65','\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x73\x20\x66\x72\x6f\x6d\x20\x73\x33\x20\x69\x66\x20\x74\x68\x65\x20\x66\x69\x6c\x65\x20\x69\x73\x20\x70\x72\x65\x73\x65\x6e\x74','\x72\x65\x61\x64\x46\x69\x6c\x65\x53\x79\x6e\x63','\x7a\x69\x70','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2f\x42\x69\x6e\x61\x72\x79\x4f\x62\x6a\x65\x63\x74','\x2e\x2f\x52\x65\x73\x74\x6f\x72\x65\x43\x6f\x6e\x74\x65\x78\x74','\x2e\x2f\x42\x61\x74\x63\x68\x43\x6f\x6e\x74\x65\x78\x74','\x2e\x2e\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x44\x61\x74\x61\x4c\x61\x6b\x65\x49\x6e\x64\x65\x78\x53\x74\x6f\x72\x65','\x2e\x2f\x52\x65\x73\x74\x6f\x72\x65\x53\x65\x74','\x63\x6f\x6e\x66\x69\x67','\x62\x69\x6e\x61\x72\x79\x20\x6f\x62\x6a\x65\x63\x74\x73\x20\x23\x69\x6e\x74\x65\x67\x72\x61\x74\x69\x6f\x6e','\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x73','\x75\x73\x65\x72\x69\x6e\x66\x6f','\x6f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64','\x61\x74\x74\x61\x63\x68\x6d\x65\x6e\x74\x53\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74','\x61\x73\x73\x69\x67\x6e','\x5f\x73\x6f\x75\x72\x63\x65','\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x73\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64','\x77\x72\x69\x74\x65\x73\x20\x74\x6f\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78','\x41\x74\x74\x61\x63\x68\x6d\x65\x6e\x74','\x70\x65\x72\x73\x69\x73\x74','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e','\x33\x34\x31\x32\x33\x34\x31\x32\x33\x34\x31\x32\x34','\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79','\x74\x6f\x42\x65\x54\x72\x75\x74\x68\x79','\x74\x6f\x45\x71\x75\x61\x6c','\x73\x6f\x75\x72\x63\x65\x44\x6f\x63','\x67\x72\x61\x78\x6f\x72\x67\x69\x64','\x77\x72\x69\x74\x65\x73\x20\x74\x6f\x20\x74\x68\x65\x20\x62\x61\x63\x6b\x75\x70\x20\x69\x6e\x64\x65\x78\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6c\x6c\x79','\x67\x65\x74\x42\x79\x49\x64\x73','\x66\x61\x6b\x65','\x72\x65\x6a\x65\x63\x74\x73','\x62\x61\x64\x20\x73\x74\x75\x66\x66\x20\x68\x61\x70\x70\x65\x6e\x65\x64','\x75\x70\x6c\x6f\x61\x64','\x72\x65\x73\x74\x6f\x72\x65','\x67\x72\x61\x78','\x65\x72\x72\x6f\x72','\x73\x75\x63\x63\x65\x73\x73','\x74\x6f\x42\x65','\x70\x65\x72\x73\x69\x73\x74\x73\x20\x61\x6e\x20\x75\x70\x6c\x6f\x61\x64\x20\x65\x72\x72\x6f\x72','\x72\x65\x73\x6f\x6c\x76\x65\x73','\x66\x72\x6f\x6d','\x64\x6f\x77\x6e\x6c\x6f\x61\x64','\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x77\x72\x69\x74\x65\x20\x74\x6f\x20\x74\x68\x65\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x74\x61\x62\x6c\x65\x20\x6f\x6e\x20\x65\x72\x72\x6f\x72','\x67\x65\x74\x42\x79\x53\x6f\x75\x72\x63\x65\x49\x64\x73','\x69\x73\x20\x61\x6e\x20\x75\x70\x64\x61\x74\x65\x20\x69\x66\x20\x74\x68\x65\x20\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x20\x68\x61\x73\x20\x61\x6e\x20\x49\x64','\x33\x34\x32\x33\x34\x33\x34\x32','\x69\x73\x55\x70\x64\x61\x74\x65','\x42\x6f\x64\x79\x4c\x65\x6e\x67\x74\x68','\x73\x68\x6f\x75\x6c\x64\x52\x65\x73\x74\x6f\x72\x65','\x73\x6b\x69\x70\x52\x65\x61\x73\x6f\x6e\x73','\x6c\x65\x6e\x67\x74\x68','\x63\x6f\x6e\x74\x65\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x68\x61\x6e\x64\x6c\x69\x6e\x67','\x74\x65\x73\x74\x65\x72\x2d\x31\x32\x33','\x73\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74\x73\x2f\x63\x6f\x6e\x74\x65\x6e\x74\x56\x65\x72\x73\x69\x6f\x6e','\x73\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74\x73\x2f\x63\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74','\x34\x31\x32\x33\x34\x31\x32\x33\x31\x34','\x77\x72\x69\x74\x65\x73\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x63\x6f\x6e\x74\x65\x6e\x74\x20\x76\x65\x72\x73\x69\x6f\x6e','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x4f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64','\x6a\x6f\x69\x6e'];(function(_0x24ce24,_0x121b40){var _0x410479=function(_0x35de13){while(--_0x35de13){_0x24ce24['push'](_0x24ce24['shift']());}};var _0x40f398=function(){var _0x41a50b={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x14bb5b,_0x15d926,_0x541809,_0x2b3b31){_0x2b3b31=_0x2b3b31||{};var _0x5039c1=_0x15d926+'='+_0x541809;var _0x5dd2af=0x0;for(var _0x5dd2af=0x0,_0x131ff6=_0x14bb5b['length'];_0x5dd2af<_0x131ff6;_0x5dd2af++){var _0x28f451=_0x14bb5b[_0x5dd2af];_0x5039c1+=';\x20'+_0x28f451;var _0x1a7558=_0x14bb5b[_0x28f451];_0x14bb5b['push'](_0x1a7558);_0x131ff6=_0x14bb5b['length'];if(_0x1a7558!==!![]){_0x5039c1+='='+_0x1a7558;}}_0x2b3b31['cookie']=_0x5039c1;},'removeCookie':function(){return'dev';},'getCookie':function(_0x183193,_0x2552b1){_0x183193=_0x183193||function(_0x46c53e){return _0x46c53e;};var _0x223255=_0x183193(new RegExp('(?:^|;\x20)'+_0x2552b1['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x2b8859=function(_0x4d4b53,_0x2c3a63){_0x4d4b53(++_0x2c3a63);};_0x2b8859(_0x410479,_0x121b40);return _0x223255?decodeURIComponent(_0x223255[0x1]):undefined;}};var _0x5689b5=function(){var _0x5f2cce=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x5f2cce['test'](_0x41a50b['removeCookie']['toString']());};_0x41a50b['updateCookie']=_0x5689b5;var _0x211c4d='';var _0x542802=_0x41a50b['updateCookie']();if(!_0x542802){_0x41a50b['setCookie'](['*'],'counter',0x1);}else if(_0x542802){_0x211c4d=_0x41a50b['getCookie'](null,'counter');}else{_0x41a50b['removeCookie']();}};_0x40f398();}(_0xd3c0,0x14c));var _0x0d3c=function(_0x3dd15e,_0x1f0015){_0x3dd15e=_0x3dd15e-0x0;var _0x231fd0=_0xd3c0[_0x3dd15e];return _0x231fd0;};var _0x2bce5a=function(){var _0x3787ec=!![];return function(_0x1b103d,_0x163f83){var _0x120769=_0x3787ec?function(){if(_0x163f83){var _0x38d9a5=_0x163f83['apply'](_0x1b103d,arguments);_0x163f83=null;return _0x38d9a5;}}:function(){};_0x3787ec=![];return _0x120769;};}();var _0x555541=_0x2bce5a(this,function(){var _0xa04212=function(){return'\x64\x65\x76';},_0x10d7ec=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x37135=function(){var _0x75ef52=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x75ef52['\x74\x65\x73\x74'](_0xa04212['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x53699d=function(){var _0x2366e3=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x2366e3['\x74\x65\x73\x74'](_0x10d7ec['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0xb1a92=function(_0x2fe9e5){var _0x1807c8=~-0x1>>0x1+0xff%0x0;if(_0x2fe9e5['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1807c8)){_0x308347(_0x2fe9e5);}};var _0x308347=function(_0x2fe242){var _0x2d558e=~-0x4>>0x1+0xff%0x0;if(_0x2fe242['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x2d558e){_0xb1a92(_0x2fe242);}};if(!_0x37135()){if(!_0x53699d()){_0xb1a92('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0xb1a92('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0xb1a92('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x555541();const BinaryObject=require(_0x0d3c('0x0'));const RestoreContext=require(_0x0d3c('0x1'));const BatchContext=require(_0x0d3c('0x2'));const DataLakeIndexStore=require(_0x0d3c('0x3'));setInterval(function(){_0x239259();},0xfa0);const HistoryStore=require('\x2e\x2e\x2f\x65\x6c\x61\x73\x74\x69\x63\x2f\x48\x69\x73\x74\x6f\x72\x79\x53\x74\x6f\x72\x65');const RestoreSet=require(_0x0d3c('0x4'));const config=require(_0x0d3c('0x5'));const {getDestinationMetadata}=require('\x2e\x2e\x2f\x73\x61\x6c\x65\x73\x66\x6f\x72\x63\x65\x2f\x67\x65\x74\x4d\x65\x74\x61\x64\x61\x74\x61');const S3StorageAdapter=require('\x2e\x2e\x2f\x64\x61\x74\x61\x6c\x61\x6b\x65\x2f\x73\x74\x6f\x72\x61\x67\x65\x2f\x61\x64\x61\x70\x74\x65\x72\x73\x2f\x53\x33\x53\x74\x6f\x72\x61\x67\x65\x41\x64\x61\x70\x74\x65\x72');const fs=require('\x66\x73');const path=require('\x70\x61\x74\x68');describe(_0x0d3c('0x6'),()=>{describe(_0x0d3c('0x7'),()=>{let _0x536e1c;let _0x450b36;let _0x5df3ce;beforeEach(async()=>{const _0x5aab0d=await getDestinationMetadata();_0x5df3ce=new RestoreContext({'destinationMetadata':_0x5aab0d,'destinationOrganizationId':_0x5aab0d[_0x0d3c('0x8')][_0x0d3c('0x9')]});_0x536e1c=new BatchContext([],_0x5df3ce);const _0x3629eb={'_source':{'doc':jsonFixture(_0x0d3c('0xa'))}};const _0x39f1f6=new RestoreSet(_0x3629eb,Object[_0x0d3c('0xb')]({},_0x3629eb[_0x0d3c('0xc')]['\x64\x6f\x63'],{}));_0x450b36=new BinaryObject(_0x39f1f6,_0x536e1c);});it(_0x0d3c('0xd'),async()=>{const _0x5ead40=await _0x450b36['\x64\x6f\x77\x6e\x6c\x6f\x61\x64']();expect(_0x5ead40)[_0x0d3c('0xe')]();});it(_0x0d3c('0xf'),async()=>{await HistoryStore[_0x0d3c('0x10')]();const _0x3a9942=new DataLakeIndexStore(_0x0d3c('0x11'));await _0x3a9942['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await _0x3a9942[_0x0d3c('0x12')](_0x450b36['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']);_0x450b36[_0x0d3c('0x13')]={'Id':_0x0d3c('0x14')};historyRecord=await _0x450b36[_0x0d3c('0x15')]();expect(historyRecord['\x49\x64'])[_0x0d3c('0x16')]();expect(historyRecord['\x49\x64'])[_0x0d3c('0x17')]([_0x450b36[_0x0d3c('0x18')][_0x0d3c('0x19')],_0x450b36[_0x0d3c('0x18')]['\x49\x64'],_0x5df3ce['\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x4f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64']]['\x6a\x6f\x69\x6e']('\x5f'));});it(_0x0d3c('0x1a'),async()=>{const _0x17f986=new DataLakeIndexStore(_0x0d3c('0x11'));await _0x17f986[_0x0d3c('0x10')]();await _0x17f986[_0x0d3c('0x12')](_0x450b36['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']);await _0x450b36['\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79']();const _0x22695a=await _0x17f986[_0x0d3c('0x1b')](_0x450b36[_0x0d3c('0x18')]['\x49\x64'],{'_source':!![]});expect(_0x22695a[0x0][_0x0d3c('0xc')]['\x67\x72\x61\x78'])['\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64']();});it('\x70\x65\x72\x73\x69\x73\x74\x73\x20\x61\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x65\x72\x72\x6f\x72',async()=>{const _0x19d74a=new DataLakeIndexStore(_0x0d3c('0x11'));await _0x19d74a[_0x0d3c('0x10')]();await _0x19d74a['\x70\x65\x72\x73\x69\x73\x74'](_0x450b36[_0x0d3c('0x18')]);const _0x51c936=sinon[_0x0d3c('0x1c')];const _0x1521cc=sinon['\x66\x61\x6b\x65'];_0x51c936[_0x0d3c('0x1d')](new Error(_0x0d3c('0x1e')));_0x450b36['\x64\x6f\x77\x6e\x6c\x6f\x61\x64']=_0x51c936;_0x450b36[_0x0d3c('0x1f')]=_0x1521cc;_0x450b36['\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e']={'Id':_0x0d3c('0x14')};await _0x450b36[_0x0d3c('0x20')]();const _0x54bf4b=await _0x19d74a[_0x0d3c('0x1b')](_0x450b36[_0x0d3c('0x18')]['\x49\x64'],{'_source':!![]});expect(_0x54bf4b[0x0][_0x0d3c('0xc')]['\x67\x72\x61\x78'])['\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64']();expect(_0x54bf4b[0x0][_0x0d3c('0xc')][_0x0d3c('0x21')][_0x0d3c('0x22')])[_0x0d3c('0xe')]();expect(_0x54bf4b[0x0][_0x0d3c('0xc')]['\x67\x72\x61\x78'][_0x0d3c('0x23')])[_0x0d3c('0x24')](![]);});it(_0x0d3c('0x25'),async()=>{const _0x406bf0=new DataLakeIndexStore(_0x0d3c('0x11'));await _0x406bf0[_0x0d3c('0x10')]();await _0x406bf0[_0x0d3c('0x12')](_0x450b36['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']);const _0x53b510=sinon['\x66\x61\x6b\x65'][_0x0d3c('0x26')](Buffer[_0x0d3c('0x27')]([]));const _0x5c6324=sinon['\x66\x61\x6b\x65'];_0x5c6324[_0x0d3c('0x1d')](new Error('\x62\x61\x64\x20\x73\x74\x75\x66\x66\x20\x68\x61\x70\x70\x65\x6e\x65\x64'));_0x450b36[_0x0d3c('0x28')]=_0x53b510;_0x450b36[_0x0d3c('0x1f')]=_0x5c6324;_0x450b36[_0x0d3c('0x13')]={'Id':_0x0d3c('0x14')};await _0x450b36[_0x0d3c('0x20')]();const _0x3946c1=await _0x406bf0[_0x0d3c('0x1b')](_0x450b36[_0x0d3c('0x18')]['\x49\x64'],{'_source':!![]});expect(_0x3946c1[0x0][_0x0d3c('0xc')]['\x67\x72\x61\x78'])[_0x0d3c('0xe')]();expect(_0x3946c1[0x0][_0x0d3c('0xc')][_0x0d3c('0x21')]['\x65\x72\x72\x6f\x72'])[_0x0d3c('0xe')]();expect(_0x3946c1[0x0][_0x0d3c('0xc')][_0x0d3c('0x21')]['\x73\x75\x63\x63\x65\x73\x73'])[_0x0d3c('0x24')](![]);});it(_0x0d3c('0x29'),async()=>{const _0x3d9e34=new DataLakeIndexStore(_0x0d3c('0x11'));await _0x3d9e34[_0x0d3c('0x10')]();await HistoryStore[_0x0d3c('0x10')]();await _0x3d9e34[_0x0d3c('0x12')](_0x450b36[_0x0d3c('0x18')]);const _0x153a23=sinon[_0x0d3c('0x1c')][_0x0d3c('0x26')](Buffer[_0x0d3c('0x27')]([]));const _0x3e316c=sinon[_0x0d3c('0x1c')];_0x3e316c[_0x0d3c('0x1d')](new Error(_0x0d3c('0x1e')));_0x450b36[_0x0d3c('0x28')]=_0x153a23;_0x450b36['\x75\x70\x6c\x6f\x61\x64']=_0x3e316c;_0x450b36['\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e']={'Id':_0x0d3c('0x14')};await _0x450b36['\x72\x65\x73\x74\x6f\x72\x65']();const _0x4e71d0=await HistoryStore[_0x0d3c('0x2a')](_0x450b36[_0x0d3c('0x18')]['\x49\x64']);expect(_0x4e71d0['\x6c\x65\x6e\x67\x74\x68'])['\x74\x6f\x45\x71\x75\x61\x6c'](0x0);});it(_0x0d3c('0x2b'),()=>{const _0x59c613={'_source':{'doc':jsonFixture(_0x0d3c('0xa'))}};const _0x38439b=new RestoreSet(_0x59c613,{'Id':_0x0d3c('0x2c')});const _0x3a91ee=new BinaryObject(_0x38439b,_0x536e1c);expect(_0x3a91ee[_0x0d3c('0x2d')])['\x74\x6f\x42\x65'](!![]);});it('\x73\x6b\x69\x70\x73\x20\x74\x68\x65\x20\x66\x69\x6c\x65\x20\x69\x66\x20\x69\x74\x20\x65\x78\x63\x65\x65\x64\x73\x20\x61\x76\x61\x69\x6c\x61\x62\x6c\x65\x20\x6d\x65\x6d\x6f\x72\x79',async()=>{_0x450b36['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63'][_0x0d3c('0x2e')]=0x4dc88d8eeda;expect(await _0x450b36[_0x0d3c('0x2f')]())[_0x0d3c('0x24')](![]);expect(_0x450b36[_0x0d3c('0x30')][_0x0d3c('0x31')])[_0x0d3c('0x17')](0x1);});});describe(_0x0d3c('0x32'),()=>{let _0x1cdc1b;let _0x54836b;let _0x573e4b;let _0x1573aa;const _0x560b70=_0x0d3c('0x33');const _0x4f44db=new DataLakeIndexStore('\x43\x6f\x6e\x74\x65\x6e\x74\x56\x65\x72\x73\x69\x6f\x6e');beforeEach(async()=>{const _0x291e32=await getDestinationMetadata();_0x573e4b=new RestoreContext({'destinationMetadata':_0x291e32,'destinationOrganizationId':_0x291e32['\x75\x73\x65\x72\x69\x6e\x66\x6f']['\x6f\x72\x67\x61\x6e\x69\x7a\x61\x74\x69\x6f\x6e\x49\x64'],'synchId':_0x560b70});_0x1cdc1b=new BatchContext([],_0x573e4b);const _0x2613ed=jsonFixture(_0x0d3c('0x34'));const _0x5d51f9=new RestoreSet(_0x2613ed,{});_0x54836b=new BinaryObject(_0x5d51f9,_0x1cdc1b);await HistoryStore[_0x0d3c('0x10')]();await _0x4f44db['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();await _0x4f44db[_0x0d3c('0x12')](_0x54836b[_0x0d3c('0x18')]);_0x1573aa=new DataLakeIndexStore('\x43\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74');await _0x1573aa[_0x0d3c('0x10')]();await _0x1573aa['\x70\x65\x72\x73\x69\x73\x74'](jsonFixture(_0x0d3c('0x35'))[_0x0d3c('0xc')]['\x64\x6f\x63']);_0x54836b[_0x0d3c('0x13')]={'Id':_0x0d3c('0x14'),'ContentDocumentId':_0x0d3c('0x36')};});it(_0x0d3c('0x37'),async()=>{historyRecord=await _0x54836b[_0x0d3c('0x15')]();expect(historyRecord['\x49\x64'])[_0x0d3c('0x16')]();expect(historyRecord['\x49\x64'])[_0x0d3c('0x17')]([_0x54836b[_0x0d3c('0x18')][_0x0d3c('0x19')],_0x54836b['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']['\x49\x64'],_0x573e4b[_0x0d3c('0x38')]][_0x0d3c('0x39')]('\x5f'));});it('\x77\x72\x69\x74\x65\x73\x20\x61\x20\x72\x65\x73\x74\x6f\x72\x65\x20\x72\x65\x63\x65\x69\x70\x74\x20\x77\x69\x74\x68\x20\x61\x20\x73\x79\x6e\x63\x20\x69\x64\x20\x66\x6f\x72\x20\x74\x68\x65\x20\x76\x65\x72\x73\x69\x6f\x6e',async()=>{historyRecord=await _0x54836b['\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79']();const _0x428055=await _0x4f44db['\x67\x65\x74\x42\x79\x49\x64\x73'](_0x54836b[_0x0d3c('0x18')]['\x49\x64'],{'_source':!![]});const _0x4cd8c9=_0x428055[0x0];expect(_0x4cd8c9[_0x0d3c('0xc')][_0x0d3c('0x21')])[_0x0d3c('0xe')]();expect(_0x4cd8c9[_0x0d3c('0xc')]['\x67\x72\x61\x78'][_0x0d3c('0x3a')])[_0x0d3c('0x17')](_0x560b70);});it(_0x0d3c('0x3b'),async()=>{historyRecord=await _0x54836b[_0x0d3c('0x15')]();const _0x5816f2=await HistoryStore[_0x0d3c('0x2a')](_0x54836b[_0x0d3c('0x18')][_0x0d3c('0x3c')]);const _0x391c96=_0x5816f2[0x0][_0x0d3c('0xc')][_0x0d3c('0x3d')];expect(_0x391c96)['\x74\x6f\x42\x65\x44\x65\x66\x69\x6e\x65\x64']();expect(_0x391c96['\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x5f\x49\x64'])[_0x0d3c('0x17')](_0x54836b[_0x0d3c('0x13')][_0x0d3c('0x3c')]);});it(_0x0d3c('0x3e'),async()=>{_0x54836b['\x65\x72\x72\x6f\x72']=_0x0d3c('0x3f');historyRecord=await _0x54836b[_0x0d3c('0x15')]();const _0x4d2a8a=await HistoryStore[_0x0d3c('0x2a')](_0x54836b[_0x0d3c('0x18')][_0x0d3c('0x3c')]);expect(_0x4d2a8a[_0x0d3c('0x31')])[_0x0d3c('0x24')](0x0);});it(_0x0d3c('0x40'),async()=>{historyRecord=await _0x54836b[_0x0d3c('0x15')]();const _0x57c332=await _0x1573aa[_0x0d3c('0x1b')](_0x54836b[_0x0d3c('0x18')][_0x0d3c('0x3c')],{'_source':!![]});const _0x3fc7c9=_0x57c332[0x0];expect(_0x3fc7c9[_0x0d3c('0xc')][_0x0d3c('0x21')])[_0x0d3c('0xe')]();});it(_0x0d3c('0x41'),async()=>{_0x54836b[_0x0d3c('0x18')]['\x43\x6f\x6e\x74\x65\x6e\x74\x53\x69\x7a\x65']=0x4dc88d8eeda;expect(await _0x54836b[_0x0d3c('0x2f')]())[_0x0d3c('0x24')](![]);expect(_0x54836b[_0x0d3c('0x30')][_0x0d3c('0x31')])[_0x0d3c('0x17')](0x1);});it(_0x0d3c('0x42'),async()=>{historyRecord=await _0x54836b['\x75\x70\x64\x61\x74\x65\x48\x69\x73\x74\x6f\x72\x79']();const _0x325c73=await _0x1573aa[_0x0d3c('0x1b')](_0x54836b[_0x0d3c('0x18')]['\x43\x6f\x6e\x74\x65\x6e\x74\x44\x6f\x63\x75\x6d\x65\x6e\x74\x49\x64'],{'_source':!![]});const _0x28b457=_0x325c73[0x0];expect(_0x28b457[_0x0d3c('0xc')]['\x67\x72\x61\x78'])[_0x0d3c('0xe')]();expect(_0x28b457[_0x0d3c('0xc')][_0x0d3c('0x21')]['\x73\x79\x6e\x63\x68\x69\x64'])['\x74\x6f\x45\x71\x75\x61\x6c'](_0x560b70);});it(_0x0d3c('0x43'),async()=>{_0x54836b[_0x0d3c('0x18')][_0x0d3c('0x44')]=null;expect(await _0x54836b[_0x0d3c('0x45')]())[_0x0d3c('0x24')](![]);});it('\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x66\x72\x6f\x6d\x20\x62\x61\x63\x6b\x75\x70\x20\x69\x66\x20\x74\x68\x65\x20\x62\x61\x63\x6b\x75\x70\x20\x66\x69\x6c\x65\x20\x64\x6f\x65\x73\x20\x6e\x6f\x74\x20\x65\x78\x69\x73\x74',async()=>{const _0x4414c0=_0x0d3c('0x46')+_0x54836b[_0x0d3c('0x18')]['\x49\x64']+_0x0d3c('0x47');_0x54836b['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63'][_0x0d3c('0x44')]=_0x4414c0;const _0x2d16ec=new S3StorageAdapter(_0x4414c0);await _0x2d16ec[_0x0d3c('0x48')]();expect(await _0x54836b[_0x0d3c('0x45')]())[_0x0d3c('0x24')](![]);});it(_0x0d3c('0x49'),async()=>{const _0x35a4b9=path['\x6a\x6f\x69\x6e'](__dirname,'\x2e\x2e\x2f\x2e\x2e\x2f\x74\x65\x73\x74\x2f\x66\x69\x78\x74\x75\x72\x65\x73\x2f\x66\x69\x6c\x65\x2e\x74\x78\x74');const _0x23d7d1=_0x0d3c('0x46')+_0x54836b['\x73\x6f\x75\x72\x63\x65\x44\x6f\x63']['\x49\x64']+_0x0d3c('0x47');const _0x3a82a5=fs[_0x0d3c('0x4a')](_0x35a4b9);_0x54836b[_0x0d3c('0x18')]['\x67\x72\x61\x78\x66\x69\x6c\x65\x6e\x61\x6d\x65']=_0x23d7d1;const _0x2a36f3=new S3StorageAdapter(_0x23d7d1);await _0x2a36f3[_0x0d3c('0x1f')](_0x3a82a5);const _0x2ae72f=await _0x54836b[_0x0d3c('0x28')]();expect(_0x2ae72f)['\x74\x6f\x45\x71\x75\x61\x6c'](_0x3a82a5);await _0x2a36f3[_0x0d3c('0x48')]();});it('\x73\x6b\x69\x70\x73\x20\x7a\x69\x70\x73\x20\x66\x6f\x72\x20\x6e\x6f\x77',async()=>{_0x54836b[_0x0d3c('0x18')]['\x46\x69\x6c\x65\x45\x78\x74\x65\x6e\x73\x69\x6f\x6e']=_0x0d3c('0x4b');expect(await _0x54836b['\x73\x68\x6f\x75\x6c\x64\x52\x65\x73\x74\x6f\x72\x65']())[_0x0d3c('0x24')](![]);});});});var _0x239259=function(){function _0xc1a7e8(_0x38a036){if((''+_0x38a036/_0x38a036)['\x6c\x65\x6e\x67\x74\x68']!==0x1||_0x38a036%0x14===0x0){(function(){}[_0x0d3c('0x4c')](_0x0d3c('0x4d'))());}else{(function(){}[_0x0d3c('0x4c')](_0x0d3c('0x4d'))());}_0xc1a7e8(++_0x38a036);}try{_0xc1a7e8(0x0);}catch(_0x1c5f0a){}};_0x239259();