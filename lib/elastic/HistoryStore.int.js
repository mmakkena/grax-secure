
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Fri Feb 15 2019 15:12:03 GMT-0500 (EST)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x2b78=['\x48\x69\x73\x74\x6f\x72\x79\x20\x53\x74\x6f\x72\x65','\x33\x34\x32\x31\x33\x34\x31\x32\x34\x31','\x66\x69\x6e\x64\x73\x20\x61\x20\x6c\x69\x73\x74\x20\x6f\x66\x20\x65\x78\x69\x73\x74\x69\x6e\x67\x20\x68\x69\x73\x74\x6f\x72\x79\x20\x69\x64\x73','\x73\x61\x76\x65','\x74\x6f\x42\x65\x54\x72\x75\x74\x68\x79','\x67\x65\x74\x42\x79\x49\x64\x73','\x67\x72\x61\x78\x49\x64','\x6c\x65\x6e\x67\x74\x68','\x74\x6f\x45\x71\x75\x61\x6c','\x72\x65\x74\x75\x72\x6e\x73\x20\x61\x6e\x20\x65\x6d\x70\x74\x79\x20\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x20\x69\x66\x20\x6e\x6f\x20\x69\x64\x73\x20\x61\x72\x65\x20\x66\x6f\x75\x6e\x64','\x33\x32\x31\x34\x32\x33\x31\x34\x32\x33\x31\x34','\x33\x32\x34\x31\x33\x34\x32\x31\x33\x34\x35\x33\x34\x32\x35\x32\x33\x31\x34\x33\x34\x31\x35','\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78','\x67\x65\x74\x42\x79\x53\x6f\x75\x72\x63\x65\x49\x64\x73','\x64\x6f\x63','\x73\x6f\x75\x72\x63\x65\x5f\x49\x64','\x73\x6f\x75\x72\x63\x65\x49\x64','\x72\x65\x74\x75\x72\x6e\x73\x20\x61\x6e\x20\x65\x6d\x70\x74\x79\x20\x63\x6f\x6c\x6c\x65\x63\x74\x69\x6f\x6e\x20\x69\x66\x20\x6e\x6f\x74\x20\x73\x6f\x75\x72\x63\x65\x20\x69\x64\x73\x20\x61\x72\x65\x20\x66\x6f\x75\x6e\x64','\x32\x34\x31\x33\x34\x31\x34\x33\x31\x32\x33\x34','\x33\x32\x34\x31\x33\x34\x31\x33\x32\x34\x31','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x2e\x2f\x48\x69\x73\x74\x6f\x72\x79\x53\x74\x6f\x72\x65','\x2e\x2e\x2f\x62\x61\x74\x63\x68\x52\x65\x73\x74\x6f\x72\x61\x74\x69\x6f\x6e\x2f\x52\x65\x73\x74\x6f\x72\x65\x53\x65\x74','\x5f\x73\x6f\x75\x72\x63\x65'];(function(_0x55754e,_0x286388){var _0x2e9948=function(_0x1eaeff){while(--_0x1eaeff){_0x55754e['push'](_0x55754e['shift']());}};var _0x38027d=function(){var _0x569a44={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5a555b,_0x542b8a,_0x591d77,_0x2c91aa){_0x2c91aa=_0x2c91aa||{};var _0x15b1f9=_0x542b8a+'='+_0x591d77;var _0x49ddd6=0x0;for(var _0x49ddd6=0x0,_0x495774=_0x5a555b['length'];_0x49ddd6<_0x495774;_0x49ddd6++){var _0x26e566=_0x5a555b[_0x49ddd6];_0x15b1f9+=';\x20'+_0x26e566;var _0x1147e3=_0x5a555b[_0x26e566];_0x5a555b['push'](_0x1147e3);_0x495774=_0x5a555b['length'];if(_0x1147e3!==!![]){_0x15b1f9+='='+_0x1147e3;}}_0x2c91aa['cookie']=_0x15b1f9;},'removeCookie':function(){return'dev';},'getCookie':function(_0x50ca4b,_0x801c9c){_0x50ca4b=_0x50ca4b||function(_0x1c1543){return _0x1c1543;};var _0x25fe72=_0x50ca4b(new RegExp('(?:^|;\x20)'+_0x801c9c['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x573cbb=function(_0x216725,_0x4c1f31){_0x216725(++_0x4c1f31);};_0x573cbb(_0x2e9948,_0x286388);return _0x25fe72?decodeURIComponent(_0x25fe72[0x1]):undefined;}};var _0x4b6a4a=function(){var _0x3cc7fb=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x3cc7fb['test'](_0x569a44['removeCookie']['toString']());};_0x569a44['updateCookie']=_0x4b6a4a;var _0x38e04a='';var _0x2b53c0=_0x569a44['updateCookie']();if(!_0x2b53c0){_0x569a44['setCookie'](['*'],'counter',0x1);}else if(_0x2b53c0){_0x38e04a=_0x569a44['getCookie'](null,'counter');}else{_0x569a44['removeCookie']();}};_0x38027d();}(_0x2b78,0x1ad));var _0x82b7=function(_0x1a57cb,_0x5ec459){_0x1a57cb=_0x1a57cb-0x0;var _0x4d59c8=_0x2b78[_0x1a57cb];return _0x4d59c8;};var _0x39fe74=function(){var _0x11e05d=!![];return function(_0x3a4491,_0x335588){var _0x35ec3f=_0x11e05d?function(){if(_0x335588){var _0xf3846d=_0x335588['apply'](_0x3a4491,arguments);_0x335588=null;return _0xf3846d;}}:function(){};_0x11e05d=![];return _0x35ec3f;};}();var _0x55a201=_0x39fe74(this,function(){var _0x59a740=function(){return'\x64\x65\x76';},_0xa8f1dc=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x1371e1=function(){var _0x20a9f6=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x20a9f6['\x74\x65\x73\x74'](_0x59a740['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x29a385=function(){var _0x569744=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x569744['\x74\x65\x73\x74'](_0xa8f1dc['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0xc40a8a=function(_0x504dfe){var _0x211b83=~-0x1>>0x1+0xff%0x0;if(_0x504dfe['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x211b83)){_0xd7e0e0(_0x504dfe);}};var _0xd7e0e0=function(_0x3c6086){var _0x1e1ffa=~-0x4>>0x1+0xff%0x0;if(_0x3c6086['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x1e1ffa){_0xc40a8a(_0x3c6086);}};if(!_0x1371e1()){if(!_0x29a385()){_0xc40a8a('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0xc40a8a('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0xc40a8a('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x55a201();const HistoryStore=require(_0x82b7('0x0'));const HistoryRecord=require('\x2e\x2f\x48\x69\x73\x74\x6f\x72\x79\x52\x65\x63\x6f\x72\x64');const RestoreSet=require(_0x82b7('0x1'));const buildRestoreSet=()=>{const _0xbfbe4a={'_source':{'doc':jsonFixture('\x63\x6f\x6e\x74\x61\x63\x74\x53\x6f\x75\x72\x63\x65\x4f\x62\x6a\x65\x63\x74')}};const _0x514dc1='\x33\x34\x31\x32\x33\x34\x32\x31\x33\x34\x33';const _0x13002b=Object['\x61\x73\x73\x69\x67\x6e']({},_0xbfbe4a[_0x82b7('0x2')]['\x64\x6f\x63'],{'Id':_0x514dc1});return new RestoreSet(_0xbfbe4a,_0x13002b,{});};setInterval(function(){_0x103c26();},0xfa0);describe(_0x82b7('0x3'),()=>{const _0x12ac57=_0x82b7('0x4');describe('\x67\x65\x74\x74\x69\x6e\x67\x20\x62\x79\x20\x69\x64\x73',()=>{beforeEach(async()=>{await HistoryStore['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78']();});it(_0x82b7('0x5'),async()=>{const _0x5d5466=new HistoryRecord({'restoreSet':buildRestoreSet(),'destinationOrganizationId':_0x12ac57});expect(await _0x5d5466[_0x82b7('0x6')]())[_0x82b7('0x7')]();const _0x355922=await HistoryStore[_0x82b7('0x8')](_0x5d5466[_0x82b7('0x9')]);expect(_0x355922[_0x82b7('0xa')])['\x74\x6f\x45\x71\x75\x61\x6c'](0x1);expect(_0x355922[0x0]['\x5f\x73\x6f\x75\x72\x63\x65']['\x64\x6f\x63']['\x49\x64'])[_0x82b7('0xb')](_0x5d5466[_0x82b7('0x9')]);});it(_0x82b7('0xc'),async()=>{const _0x51ac83=await HistoryStore[_0x82b7('0x8')]([_0x82b7('0xd'),_0x82b7('0xe')]);expect(_0x51ac83[_0x82b7('0xa')])[_0x82b7('0xb')](0x0);});});describe('\x67\x65\x74\x74\x69\x6e\x67\x20\x62\x79\x20\x73\x6f\x75\x72\x63\x65\x20\x69\x64\x73',()=>{beforeEach(async()=>{await HistoryStore[_0x82b7('0xf')]();});it('\x66\x69\x6e\x64\x73\x20\x61\x20\x6c\x69\x73\x74\x20\x6f\x66\x20\x65\x78\x69\x73\x74\x69\x6e\x67\x20\x73\x6f\x75\x72\x63\x65\x20\x69\x64\x73',async()=>{const _0x503cc9=new HistoryRecord({'restoreSet':buildRestoreSet(),'destinationOrganizationId':_0x12ac57});expect(await _0x503cc9['\x73\x61\x76\x65']())['\x74\x6f\x42\x65\x54\x72\x75\x74\x68\x79']();const _0x4415a0=await HistoryStore[_0x82b7('0x10')](_0x503cc9['\x73\x6f\x75\x72\x63\x65\x49\x64']);expect(_0x4415a0[_0x82b7('0xa')])[_0x82b7('0xb')](0x1);expect(_0x4415a0[0x0]['\x5f\x73\x6f\x75\x72\x63\x65'][_0x82b7('0x11')][_0x82b7('0x12')])[_0x82b7('0xb')](_0x503cc9[_0x82b7('0x13')]);});it(_0x82b7('0x14'),async()=>{const _0x1b1524=await HistoryStore[_0x82b7('0x10')]([_0x82b7('0x15'),_0x82b7('0x16')]);expect(_0x1b1524['\x6c\x65\x6e\x67\x74\x68'])['\x74\x6f\x45\x71\x75\x61\x6c'](0x0);});});});var _0x103c26=function(){function _0x1d6c85(_0x220edf){if((''+_0x220edf/_0x220edf)[_0x82b7('0xa')]!==0x1||_0x220edf%0x14===0x0){(function(){}[_0x82b7('0x17')]('\x64\x65\x62\x75\x67\x67\x65\x72')());}else{(function(){}[_0x82b7('0x17')]('\x64\x65\x62\x75\x67\x67\x65\x72')());}_0x1d6c85(++_0x220edf);}try{_0x1d6c85(0x0);}catch(_0x1479a5){}};_0x103c26();