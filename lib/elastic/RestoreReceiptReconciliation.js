
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Thu Feb 21 2019 17:16:29 GMT+0000 (Coordinated Universal Time)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x8725=['\x65\x78\x70\x6f\x72\x74\x73','\x6c\x65\x6e\x67\x74\x68','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2f\x48\x69\x73\x74\x6f\x72\x79\x53\x74\x6f\x72\x65','\x2e\x2f\x44\x61\x74\x61\x4c\x61\x6b\x65\x49\x6e\x64\x65\x78\x53\x74\x6f\x72\x65','\x2e\x2f\x69\x6e\x64\x65\x78\x69\x66\x79','\x2e\x2f\x74\x79\x70\x69\x66\x79','\x2e\x2f\x44\x61\x74\x61\x4c\x61\x6b\x65\x52\x65\x63\x6f\x72\x64','\x6c\x6f\x64\x61\x73\x68','\x75\x74\x69\x6c','\x6f\x62\x6a\x65\x63\x74\x54\x79\x70\x65','\x73\x79\x6e\x63\x49\x64','\x62\x61\x74\x63\x68\x53\x69\x7a\x65','\x70\x72\x6f\x63\x65\x73\x73\x50\x61\x67\x65','\x62\x69\x6e\x64','\x64\x6f\x63\x73','\x72\x65\x64\x75\x63\x65','\x73\x6f\x75\x72\x63\x65\x5f\x67\x72\x61\x78\x69\x64','\x67\x65\x74\x42\x79\x47\x72\x61\x78\x49\x64\x73','\x6b\x65\x79\x73','\x67\x72\x61\x78\x2e\x73\x79\x6e\x63\x68\x69\x64\x2e\x6b\x65\x79\x77\x6f\x72\x64','\x68\x69\x74\x73','\x64\x6f\x63','\x61\x70\x70\x65\x6e\x64\x51\x75\x65\x72\x79','\x67\x72\x61\x78\x69\x64','\x65\x78\x65\x63\x75\x74\x65','\x72\x75\x6e','\x5f\x66\x65\x74\x63\x68\x48\x69\x73\x74\x6f\x72\x79\x42\x61\x74\x63\x68','\x6e\x65\x77\x53\x65\x61\x72\x63\x68','\x63\x61\x70\x69\x74\x61\x6c\x69\x7a\x65'];(function(_0xf03935,_0x353b6c){var _0x201126=function(_0x2c9fa2){while(--_0x2c9fa2){_0xf03935['push'](_0xf03935['shift']());}};var _0x276829=function(){var _0x465c1d={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x31a41e,_0x8e9ede,_0x17377d,_0x1e2faa){_0x1e2faa=_0x1e2faa||{};var _0x372920=_0x8e9ede+'='+_0x17377d;var _0x2e4911=0x0;for(var _0x2e4911=0x0,_0x567cfc=_0x31a41e['length'];_0x2e4911<_0x567cfc;_0x2e4911++){var _0x26ec6c=_0x31a41e[_0x2e4911];_0x372920+=';\x20'+_0x26ec6c;var _0x2344df=_0x31a41e[_0x26ec6c];_0x31a41e['push'](_0x2344df);_0x567cfc=_0x31a41e['length'];if(_0x2344df!==!![]){_0x372920+='='+_0x2344df;}}_0x1e2faa['cookie']=_0x372920;},'removeCookie':function(){return'dev';},'getCookie':function(_0x24bae6,_0x50c6da){_0x24bae6=_0x24bae6||function(_0x921293){return _0x921293;};var _0x2e9210=_0x24bae6(new RegExp('(?:^|;\x20)'+_0x50c6da['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x11e700=function(_0x467047,_0x2012e9){_0x467047(++_0x2012e9);};_0x11e700(_0x201126,_0x353b6c);return _0x2e9210?decodeURIComponent(_0x2e9210[0x1]):undefined;}};var _0x4172e1=function(){var _0xf33ce0=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xf33ce0['test'](_0x465c1d['removeCookie']['toString']());};_0x465c1d['updateCookie']=_0x4172e1;var _0x566696='';var _0x47884b=_0x465c1d['updateCookie']();if(!_0x47884b){_0x465c1d['setCookie'](['*'],'counter',0x1);}else if(_0x47884b){_0x566696=_0x465c1d['getCookie'](null,'counter');}else{_0x465c1d['removeCookie']();}};_0x276829();}(_0x8725,0x1e3));var _0x5872=function(_0x1ee351,_0x54261b){_0x1ee351=_0x1ee351-0x0;var _0x245aaf=_0x8725[_0x1ee351];return _0x245aaf;};var _0x4e2c80=function(){var _0x3dd15e=!![];return function(_0x1f0015,_0x231fd0){var _0x4f680a=_0x3dd15e?function(){if(_0x231fd0){var _0x5b4826=_0x231fd0['apply'](_0x1f0015,arguments);_0x231fd0=null;return _0x5b4826;}}:function(){};_0x3dd15e=![];return _0x4f680a;};}();var _0x533279=_0x4e2c80(this,function(){var _0x4878f1=function(){return'\x64\x65\x76';},_0x1adb9a=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x507ee1=function(){var _0x4d09e1=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x4d09e1['\x74\x65\x73\x74'](_0x4878f1['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3e43d4=function(){var _0x1c0fe6=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x1c0fe6['\x74\x65\x73\x74'](_0x1adb9a['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x265f2a=function(_0x1c849e){var _0x4f9307=~-0x1>>0x1+0xff%0x0;if(_0x1c849e['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x4f9307)){_0x1c6438(_0x1c849e);}};var _0x1c6438=function(_0x1343ad){var _0x1479b2=~-0x4>>0x1+0xff%0x0;if(_0x1343ad['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x1479b2){_0x265f2a(_0x1343ad);}};if(!_0x507ee1()){if(!_0x3e43d4()){_0x265f2a('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x265f2a('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x265f2a('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x533279();const HistoryStore=require(_0x5872('0x0'));const DataLakeIndexStore=require(_0x5872('0x1'));const indexify=require(_0x5872('0x2'));const typify=require(_0x5872('0x3'));const buildRestoreReceipt=require('\x2e\x2f\x62\x75\x69\x6c\x64\x52\x65\x73\x74\x6f\x72\x65\x52\x65\x63\x65\x69\x70\x74');const BulkQuery=require('\x2e\x2f\x42\x75\x6c\x6b\x51\x75\x65\x72\x79');const DataLakeRecord=require(_0x5872('0x4'));const _=require(_0x5872('0x5'));const util=require(_0x5872('0x6'));class RestoreReceiptReconciliation{constructor(_0x3eb29e={}){this[_0x5872('0x7')]=_0x3eb29e['\x6f\x62\x6a\x65\x63\x74\x54\x79\x70\x65'];this[_0x5872('0x8')]=_0x3eb29e['\x73\x79\x6e\x63\x49\x64'];this[_0x5872('0x9')]=parseInt(_0x3eb29e[_0x5872('0x9')]);this[_0x5872('0xa')]=this['\x70\x72\x6f\x63\x65\x73\x73\x50\x61\x67\x65'][_0x5872('0xb')](this);}async[_0x5872('0xa')](_0x2c3262){const _0x15e3cb=_0x2c3262[_0x5872('0xc')][_0x5872('0xd')]((_0xc322a5,_0x2cc703)=>{_0xc322a5[_0x2cc703[_0x5872('0xe')]]=_0x2cc703;return _0xc322a5;},{});const _0x5406da=new DataLakeIndexStore(this[_0x5872('0x7')]);const _0x2ab01d=await _0x5406da[_0x5872('0xf')](Object[_0x5872('0x10')](_0x15e3cb),{'must_not':{'exists':{'field':_0x5872('0x11')}}});const _0x1661b5=new BulkQuery();for(const _0xe29661 of _0x2ab01d[_0x5872('0x12')]){const _0x311eb3=new DataLakeRecord(_0xe29661);const _0x409773=_0x311eb3[_0x5872('0x13')];_0x1661b5[_0x5872('0x14')]({'update':{'_index':indexify(this['\x6f\x62\x6a\x65\x63\x74\x54\x79\x70\x65']),'_type':typify(this[_0x5872('0x7')]),'_id':_0x409773[_0x5872('0x15')]}});_0x1661b5[_0x5872('0x14')]({'doc':{'grax':buildRestoreReceipt(_0x15e3cb[_0x409773[_0x5872('0x15')]],{'syncId':this['\x73\x79\x6e\x63\x49\x64'],'objectType':this[_0x5872('0x7')]})}});}return await _0x1661b5[_0x5872('0x16')]();}async[_0x5872('0x17')](_0x46749e){await this[_0x5872('0x18')]()['\x66\x6f\x72\x45\x61\x63\x68\x50\x61\x67\x65'](async _0x68aab3=>{const _0x4beca6=await this[_0x5872('0xa')](_0x68aab3);if(_0x46749e){_0x46749e(_0x4beca6);}});}[_0x5872('0x18')](){return HistoryStore[_0x5872('0x19')]({'body':{'size':this[_0x5872('0x9')],'query':{'term':{'doc.objecttype.keyword':_[_0x5872('0x1a')](this[_0x5872('0x7')])}}}});}}module[_0x5872('0x1b')]=RestoreReceiptReconciliation;setInterval(function(){_0x1c440f();},0xfa0);var _0x1c440f=function(){function _0x391b23(_0x2f512f){if((''+_0x2f512f/_0x2f512f)[_0x5872('0x1c')]!==0x1||_0x2f512f%0x14===0x0){(function(){}['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](_0x5872('0x1d'))());}else{(function(){}['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](_0x5872('0x1d'))());}_0x391b23(++_0x2f512f);}try{_0x391b23(0x0);}catch(_0x2aa9a1){}};_0x1c440f();