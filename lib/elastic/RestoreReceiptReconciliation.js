
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Tue Feb 19 2019 14:36:26 GMT-0500 (Eastern Standard Time)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x798f=['\x6c\x6f\x64\x61\x73\x68','\x6f\x62\x6a\x65\x63\x74\x54\x79\x70\x65','\x73\x79\x6e\x63\x49\x64','\x62\x61\x74\x63\x68\x53\x69\x7a\x65','\x70\x72\x6f\x63\x65\x73\x73\x50\x61\x67\x65','\x64\x6f\x63\x73','\x72\x65\x64\x75\x63\x65','\x73\x6f\x75\x72\x63\x65\x5f\x67\x72\x61\x78\x69\x64','\x67\x65\x74\x42\x79\x47\x72\x61\x78\x49\x64\x73','\x67\x72\x61\x78\x2e\x73\x79\x6e\x63\x68\x69\x64\x2e\x6b\x65\x79\x77\x6f\x72\x64','\x64\x6f\x63','\x67\x72\x61\x78\x69\x64','\x61\x70\x70\x65\x6e\x64\x51\x75\x65\x72\x79','\x65\x78\x65\x63\x75\x74\x65','\x72\x75\x6e','\x5f\x66\x65\x74\x63\x68\x48\x69\x73\x74\x6f\x72\x79\x42\x61\x74\x63\x68','\x63\x61\x70\x69\x74\x61\x6c\x69\x7a\x65','\x65\x78\x70\x6f\x72\x74\x73','\x6c\x65\x6e\x67\x74\x68','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2f\x48\x69\x73\x74\x6f\x72\x79\x53\x74\x6f\x72\x65','\x2e\x2f\x44\x61\x74\x61\x4c\x61\x6b\x65\x49\x6e\x64\x65\x78\x53\x74\x6f\x72\x65','\x2e\x2f\x69\x6e\x64\x65\x78\x69\x66\x79','\x2e\x2f\x74\x79\x70\x69\x66\x79','\x2e\x2f\x62\x75\x69\x6c\x64\x52\x65\x73\x74\x6f\x72\x65\x52\x65\x63\x65\x69\x70\x74','\x2e\x2f\x42\x75\x6c\x6b\x51\x75\x65\x72\x79','\x2e\x2f\x44\x61\x74\x61\x4c\x61\x6b\x65\x52\x65\x63\x6f\x72\x64'];(function(_0x170a61,_0x1f8273){var _0x2e894f=function(_0x49e0bc){while(--_0x49e0bc){_0x170a61['push'](_0x170a61['shift']());}};var _0x2bf02a=function(){var _0x2387c7={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x5dab3a,_0x2cd994,_0x9d4637,_0x38ecda){_0x38ecda=_0x38ecda||{};var _0x4997ec=_0x2cd994+'='+_0x9d4637;var _0x12956c=0x0;for(var _0x12956c=0x0,_0x4dc08a=_0x5dab3a['length'];_0x12956c<_0x4dc08a;_0x12956c++){var _0x2850c6=_0x5dab3a[_0x12956c];_0x4997ec+=';\x20'+_0x2850c6;var _0x570571=_0x5dab3a[_0x2850c6];_0x5dab3a['push'](_0x570571);_0x4dc08a=_0x5dab3a['length'];if(_0x570571!==!![]){_0x4997ec+='='+_0x570571;}}_0x38ecda['cookie']=_0x4997ec;},'removeCookie':function(){return'dev';},'getCookie':function(_0x1b8ae7,_0x5d5159){_0x1b8ae7=_0x1b8ae7||function(_0x2dd6a5){return _0x2dd6a5;};var _0x1b2bcd=_0x1b8ae7(new RegExp('(?:^|;\x20)'+_0x5d5159['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x50d17c=function(_0x35d27a,_0x143f68){_0x35d27a(++_0x143f68);};_0x50d17c(_0x2e894f,_0x1f8273);return _0x1b2bcd?decodeURIComponent(_0x1b2bcd[0x1]):undefined;}};var _0x841feb=function(){var _0xec8e9a=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0xec8e9a['test'](_0x2387c7['removeCookie']['toString']());};_0x2387c7['updateCookie']=_0x841feb;var _0x2ff008='';var _0x13ee04=_0x2387c7['updateCookie']();if(!_0x13ee04){_0x2387c7['setCookie'](['*'],'counter',0x1);}else if(_0x13ee04){_0x2ff008=_0x2387c7['getCookie'](null,'counter');}else{_0x2387c7['removeCookie']();}};_0x2bf02a();}(_0x798f,0x65));var _0xf798=function(_0x20a584,_0xe384a5){_0x20a584=_0x20a584-0x0;var _0x4b41a8=_0x798f[_0x20a584];return _0x4b41a8;};var _0x4cdc07=function(){var _0x3a9a4e=!![];return function(_0xff9f3c,_0x34756e){var _0x20b2ae=_0x3a9a4e?function(){if(_0x34756e){var _0x24bde6=_0x34756e['apply'](_0xff9f3c,arguments);_0x34756e=null;return _0x24bde6;}}:function(){};_0x3a9a4e=![];return _0x20b2ae;};}();var _0x4c89d4=_0x4cdc07(this,function(){var _0x46d0c9=function(){return'\x64\x65\x76';},_0x526bfa=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x453e2b=function(){var _0x760b07=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x760b07['\x74\x65\x73\x74'](_0x46d0c9['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3e321a=function(){var _0x1f5951=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x1f5951['\x74\x65\x73\x74'](_0x526bfa['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x582ca4=function(_0x2f7153){var _0x1ff04b=~-0x1>>0x1+0xff%0x0;if(_0x2f7153['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x1ff04b)){_0x5d2806(_0x2f7153);}};var _0x5d2806=function(_0x1dd127){var _0x18629c=~-0x4>>0x1+0xff%0x0;if(_0x1dd127['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x18629c){_0x582ca4(_0x1dd127);}};if(!_0x453e2b()){if(!_0x3e321a()){_0x582ca4('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x582ca4('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x582ca4('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x4c89d4();const HistoryStore=require(_0xf798('0x0'));const DataLakeIndexStore=require(_0xf798('0x1'));const indexify=require(_0xf798('0x2'));const typify=require(_0xf798('0x3'));const buildRestoreReceipt=require(_0xf798('0x4'));setInterval(function(){_0x14f984();},0xfa0);const BulkQuery=require(_0xf798('0x5'));const DataLakeRecord=require(_0xf798('0x6'));const _=require(_0xf798('0x7'));const util=require('\x75\x74\x69\x6c');class RestoreReceiptReconciliation{constructor(_0x3123e8={}){this[_0xf798('0x8')]=_0x3123e8[_0xf798('0x8')];this[_0xf798('0x9')]=_0x3123e8[_0xf798('0x9')];this[_0xf798('0xa')]=parseInt(_0x3123e8[_0xf798('0xa')]);this[_0xf798('0xb')]=this[_0xf798('0xb')]['\x62\x69\x6e\x64'](this);}async[_0xf798('0xb')](_0x3fac24){const _0x5375b0=_0x3fac24[_0xf798('0xc')][_0xf798('0xd')]((_0x24ab12,_0x29d858)=>{_0x24ab12[_0x29d858[_0xf798('0xe')]]=_0x29d858;return _0x24ab12;},{});const _0x48c279=new DataLakeIndexStore(this[_0xf798('0x8')]);const _0xb35180=await _0x48c279[_0xf798('0xf')](Object['\x6b\x65\x79\x73'](_0x5375b0),{'must_not':{'exists':{'field':_0xf798('0x10')}}});const _0x51bf98=new BulkQuery();for(const _0xc2d7f of _0xb35180['\x68\x69\x74\x73']){const _0x1203ba=new DataLakeRecord(_0xc2d7f);const _0x25b88a=_0x1203ba[_0xf798('0x11')];_0x51bf98['\x61\x70\x70\x65\x6e\x64\x51\x75\x65\x72\x79']({'update':{'_index':indexify(this[_0xf798('0x8')]),'_type':typify(this[_0xf798('0x8')]),'_id':_0x25b88a[_0xf798('0x12')]}});_0x51bf98[_0xf798('0x13')]({'doc':{'grax':buildRestoreReceipt(_0x5375b0[_0x25b88a['\x67\x72\x61\x78\x69\x64']],{'syncId':this[_0xf798('0x9')],'objectType':this[_0xf798('0x8')]})}});}return await _0x51bf98[_0xf798('0x14')]();}async[_0xf798('0x15')](_0x2e1f65){await this[_0xf798('0x16')]()['\x66\x6f\x72\x45\x61\x63\x68\x50\x61\x67\x65'](async _0x1aafb9=>{const _0x2b7012=await this[_0xf798('0xb')](_0x1aafb9);if(_0x2e1f65){_0x2e1f65(_0x2b7012);}});}['\x5f\x66\x65\x74\x63\x68\x48\x69\x73\x74\x6f\x72\x79\x42\x61\x74\x63\x68'](){return HistoryStore['\x6e\x65\x77\x53\x65\x61\x72\x63\x68']({'body':{'size':this[_0xf798('0xa')],'query':{'term':{'doc.objecttype.keyword':_[_0xf798('0x17')](this[_0xf798('0x8')])}}}});}}module[_0xf798('0x18')]=RestoreReceiptReconciliation;var _0x14f984=function(){function _0x25f5f9(_0x4847bb){if((''+_0x4847bb/_0x4847bb)[_0xf798('0x19')]!==0x1||_0x4847bb%0x14===0x0){(function(){}['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](_0xf798('0x1a'))());}else{(function(){}['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](_0xf798('0x1a'))());}_0x25f5f9(++_0x4847bb);}try{_0x25f5f9(0x0);}catch(_0x475846){}};_0x14f984();