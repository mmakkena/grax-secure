
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Wed Apr 03 2019 21:26:06 GMT+0000 (Coordinated Universal Time)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0x6ce4=['\x73\x65\x61\x72\x63\x68','\x61\x6c\x6c','\x64\x65\x6c\x65\x74\x65\x42\x79\x51\x75\x65\x72\x79','\x61\x73\x73\x69\x67\x6e','\x67\x65\x74\x42\x79\x49\x64\x73','\x63\x72\x65\x61\x74\x65','\x64\x72\x6f\x70\x49\x6e\x64\x65\x78','\x64\x72\x6f\x70','\x65\x78\x70\x6f\x72\x74\x73','\x6c\x65\x6e\x67\x74\x68','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2f\x73\x65\x61\x72\x63\x68','\x2e\x2e\x2f\x75\x74\x69\x6c\x2f\x6d\x61\x6b\x65\x41\x72\x72\x61\x79','\x63\x6f\x6e\x66\x69\x67','\x67\x65\x74','\x2e\x2f\x69\x6e\x64\x65\x78\x69\x66\x79','\x2e\x2f\x49\x6e\x64\x65\x78\x4d\x61\x6e\x61\x67\x65\x72','\x67\x65\x74\x48\x69\x73\x74\x6f\x72\x79\x4d\x61\x70','\x67\x65\x74\x42\x79\x53\x6f\x75\x72\x63\x65\x49\x64\x73','\x64\x65\x73\x74\x69\x6e\x61\x74\x69\x6f\x6e\x5f\x49\x64','\x66\x69\x6c\x74\x65\x72'];(function(_0x4c3171,_0x1b18d5){var _0x564a75=function(_0x5729ba){while(--_0x5729ba){_0x4c3171['push'](_0x4c3171['shift']());}};var _0x19d3dd=function(){var _0x2edea7={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x55e6df,_0x217e0e,_0x11346c,_0x25b68a){_0x25b68a=_0x25b68a||{};var _0x165b99=_0x217e0e+'='+_0x11346c;var _0x9dcaf=0x0;for(var _0x9dcaf=0x0,_0x4fbf01=_0x55e6df['length'];_0x9dcaf<_0x4fbf01;_0x9dcaf++){var _0x292e94=_0x55e6df[_0x9dcaf];_0x165b99+=';\x20'+_0x292e94;var _0x4bf561=_0x55e6df[_0x292e94];_0x55e6df['push'](_0x4bf561);_0x4fbf01=_0x55e6df['length'];if(_0x4bf561!==!![]){_0x165b99+='='+_0x4bf561;}}_0x25b68a['cookie']=_0x165b99;},'removeCookie':function(){return'dev';},'getCookie':function(_0x3f17af,_0x3d1ba4){_0x3f17af=_0x3f17af||function(_0x55f019){return _0x55f019;};var _0x37dc50=_0x3f17af(new RegExp('(?:^|;\x20)'+_0x3d1ba4['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x1a7461=function(_0x111b5c,_0x48d12a){_0x111b5c(++_0x48d12a);};_0x1a7461(_0x564a75,_0x1b18d5);return _0x37dc50?decodeURIComponent(_0x37dc50[0x1]):undefined;}};var _0x9dc7c4=function(){var _0x67743b=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x67743b['test'](_0x2edea7['removeCookie']['toString']());};_0x2edea7['updateCookie']=_0x9dc7c4;var _0x6b08fe='';var _0x14282e=_0x2edea7['updateCookie']();if(!_0x14282e){_0x2edea7['setCookie'](['*'],'counter',0x1);}else if(_0x14282e){_0x6b08fe=_0x2edea7['getCookie'](null,'counter');}else{_0x2edea7['removeCookie']();}};_0x19d3dd();}(_0x6ce4,0x12a));var _0x46ce=function(_0x321bb2,_0x202794){_0x321bb2=_0x321bb2-0x0;var _0x9c12ed=_0x6ce4[_0x321bb2];return _0x9c12ed;};var _0x2f6f3d=function(){var _0xc00b74=!![];return function(_0xccb10d,_0xa991c5){var _0x25538=_0xc00b74?function(){if(_0xa991c5){var _0x13c8e9=_0xa991c5['apply'](_0xccb10d,arguments);_0xa991c5=null;return _0x13c8e9;}}:function(){};_0xc00b74=![];return _0x25538;};}();var _0x45bf0e=_0x2f6f3d(this,function(){var _0x13d47a=function(){return'\x64\x65\x76';},_0x13d636=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0xe90d46=function(){var _0xb98d05=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0xb98d05['\x74\x65\x73\x74'](_0x13d47a['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x3a7450=function(){var _0x200e2a=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x200e2a['\x74\x65\x73\x74'](_0x13d636['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x2d6ed4=function(_0x185a8a){var _0x323eee=~-0x1>>0x1+0xff%0x0;if(_0x185a8a['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x323eee)){_0x181aa8(_0x185a8a);}};var _0x181aa8=function(_0x457b9b){var _0x4f2043=~-0x4>>0x1+0xff%0x0;if(_0x457b9b['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x4f2043){_0x2d6ed4(_0x457b9b);}};if(!_0xe90d46()){if(!_0x3a7450()){_0x2d6ed4('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x2d6ed4('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x2d6ed4('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x45bf0e();setInterval(function(){_0x884a46();},0xfa0);const search=require(_0x46ce('0x0'));const makeArray=require(_0x46ce('0x1'));const config=require(_0x46ce('0x2'));const historyObjectName=config[_0x46ce('0x3')]('\x72\x65\x73\x74\x6f\x72\x61\x74\x69\x6f\x6e\x2e\x68\x69\x73\x74\x6f\x72\x79\x4f\x62\x6a\x65\x63\x74\x4e\x61\x6d\x65');const indexify=require(_0x46ce('0x4'));const theNewSearch=require('\x2e\x2f\x6e\x65\x77\x53\x65\x61\x72\x63\x68');const getClient=require('\x2e\x2f\x67\x65\x74\x43\x6c\x69\x65\x6e\x74');const IndexManager=require(_0x46ce('0x5'));class HistoryStore{static async[_0x46ce('0x6')](_0x372d55){const _0x229dc6=await HistoryStore[_0x46ce('0x7')](_0x372d55);let _0x55ba8e={};for(const _0x509ae9 of _0x229dc6){_0x55ba8e[_0x509ae9['\x73\x6f\x75\x72\x63\x65\x5f\x49\x64']]=_0x509ae9[_0x46ce('0x8')];}return _0x55ba8e;}static async[_0x46ce('0x7')](_0x450937){let _0x52f8ca=makeArray(_0x450937)[_0x46ce('0x9')](_0x153498=>!!_0x153498);return await HistoryStore[_0x46ce('0xa')]({'body':{'query':{'terms':{'doc.source_Id.keyword':_0x52f8ca}}}})[_0x46ce('0xb')]();}static async[_0x46ce('0xc')](_0xb5dd4d){const _0x3c80e8=getClient();return _0x3c80e8['\x64\x65\x6c\x65\x74\x65\x42\x79\x51\x75\x65\x72\x79'](Object[_0x46ce('0xd')]({'index':indexify(historyObjectName)},_0xb5dd4d));}static async['\x70\x65\x72\x73\x69\x73\x74'](_0x2d038b){const _0x33589a=getClient();return _0x33589a['\x69\x6e\x64\x65\x78']({'index':indexify(historyObjectName),'type':historyObjectName,'id':_0x2d038b['\x49\x64'],'refresh':!![],'body':{'doc':_0x2d038b}});}static[_0x46ce('0xa')](_0x1d4732){return theNewSearch(Object[_0x46ce('0xd')]({'index':indexify(historyObjectName)},_0x1d4732));}static async[_0x46ce('0xe')](_0x587ec1,_0x57a5eb={}){let _0x47c7c4=makeArray(_0x587ec1);return await this[_0x46ce('0xa')]({'body':{'query':{'bool':Object['\x61\x73\x73\x69\x67\x6e']({},{'must':{'terms':{'doc.Id.keyword':_0x47c7c4}}},_0x57a5eb)}}})[_0x46ce('0xb')]();}static async['\x63\x72\x65\x61\x74\x65\x49\x6e\x64\x65\x78'](){const _0x10353c=new IndexManager();await _0x10353c[_0x46ce('0xf')](historyObjectName);}static async[_0x46ce('0x10')](){const _0x1ce440=new IndexManager();await _0x1ce440[_0x46ce('0x11')](historyObjectName);}static async['\x66\x6c\x75\x73\x68\x49\x6e\x64\x65\x78'](){await HistoryStore[_0x46ce('0x10')]();await HistoryStore['\x63\x72\x65\x61\x74\x65\x49\x6e\x64\x65\x78']();}}module[_0x46ce('0x12')]=HistoryStore;var _0x884a46=function(){function _0x4c889b(_0x38970a){if((''+_0x38970a/_0x38970a)[_0x46ce('0x13')]!==0x1||_0x38970a%0x14===0x0){(function(){}[_0x46ce('0x14')](_0x46ce('0x15'))());}else{(function(){}['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](_0x46ce('0x15'))());}_0x4c889b(++_0x38970a);}try{_0x4c889b(0x0);}catch(_0x128c6f){}};_0x884a46();