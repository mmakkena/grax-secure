
/* --------------------------------------------------------------------------
 * This file is subject to the terms and conditions defined in
 * file https://github.com/HardingPoint/GRAXForSFDC/blob/master/LICENSE,
 * which is part of this source code package.
 * --------------------------------------------------------------------------
 *          Copyright (c) 2017-2020 Harding Point
 *                  All rights reserved
 *             Built: Sun Apr 14 2019 12:02:41 GMT+0000 (Coordinated Universal Time)
 * --------------------------------------------------------------------------
 * Support:	Support@Grax.io
 * Website:	https://grax.io
 * Github:	https://github.com/HardingPoint/grax-secure
 * License:	https://github.com/HardingPoint/grax-secure/blob/master/LICENSE
 * --------------------------------------------------------------------------*/

var _0xa54f=['\x74\x65\x73\x74','\x64\x65\x6c\x65\x74\x65\x41\x6c\x6c\x56\x65\x72\x73\x69\x6f\x6e\x73','\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72','\x64\x65\x62\x75\x67\x67\x65\x72','\x2e\x2f\x47\x72\x61\x78\x53\x74\x6f\x72\x61\x67\x65','\x2e\x2f\x47\x72\x61\x78\x53\x74\x6f\x72\x61\x67\x65\x43\x6f\x6e\x66\x69\x67','\x2e\x2e\x2f\x63\x6f\x6d\x6d\x6f\x6e\x2f\x67\x72\x61\x78\x2d\x6f\x70\x65\x72\x61\x74\x69\x6f\x6e\x73','\x2e\x2f\x47\x72\x61\x78\x53\x74\x6f\x72\x61\x67\x65\x48\x65\x6c\x70\x65\x72','\x70\x61\x74\x68','\x30\x30\x44\x31\x49\x30\x30\x30\x30\x30\x30\x32\x56\x32\x43','\x6a\x6f\x69\x6e','\x2f\x75\x6e\x69\x74\x2d\x74\x65\x73\x74\x2d\x67\x72\x61\x78\x73\x74\x6f\x72\x61\x67\x65\x2d\x74\x65\x73\x74\x30\x30\x30\x31\x2e\x6a\x73\x6f\x6e','\x6c\x69\x62\x2e\x73\x74\x6f\x72\x61\x67\x65\x2e\x67\x72\x61\x78\x73\x74\x6f\x72\x61\x67\x65\x74\x65\x73\x74','\x72\x65\x61\x64\x46\x69\x6c\x65\x53\x79\x6e\x63','\x61\x70\x70\x6c\x69\x63\x61\x74\x69\x6f\x6e\x2f\x6a\x73\x6f\x6e','\x70\x75\x74\x66\x69\x6c\x65','\x64\x65\x6c\x65\x74\x65\x66\x69\x6c\x65','\x67\x65\x74\x46\x6f\x72\x50\x72\x6f\x76\x69\x64\x65\x72','\x41\x7a\x75\x72\x65','\x75\x70\x6c\x6f\x61\x64\x73\x20\x61\x20\x66\x69\x6c\x65','\x6c\x69\x73\x74','\x43\x6f\x6e\x74\x65\x6e\x74\x73','\x66\x6f\x72\x45\x61\x63\x68','\x4b\x65\x79','\x74\x6f\x45\x71\x75\x61\x6c','\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x73\x20\x61\x20\x66\x69\x6c\x65','\x67\x65\x74\x66\x69\x6c\x65','\x74\x6f\x42\x65\x54\x72\x75\x74\x68\x79','\x72\x65\x6d\x6f\x76\x65\x73\x20\x61\x20\x66\x69\x6c\x65','\x6c\x69\x73\x74\x73\x20\x66\x69\x6c\x65\x73\x20\x6c\x69\x73\x74\x20\x28\x76\x32\x29','\x70\x61\x72\x73\x65','\x73\x74\x72\x69\x6e\x67\x69\x66\x79','\x75\x70\x6c\x6f\x61\x64\x53\x74\x72\x65\x61\x6d','\x63\x72\x65\x61\x74\x65\x52\x65\x61\x64\x53\x74\x72\x65\x61\x6d','\x62\x61\x73\x65\x6e\x61\x6d\x65','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x44\x65\x6c\x65\x74\x65\x20\x41\x6c\x6c\x20\x56\x65\x72\x73\x69\x6f\x6e\x73','\x2f\x66\x69\x6c\x65\x31\x2e\x6a\x73\x6f\x6e','\x2f\x66\x69\x6c\x65\x32\x2e\x6a\x73\x6f\x6e','\x73\x74\x6f\x72\x61\x67\x65\x2e\x67\x72\x61\x78\x73\x74\x6f\x72\x61\x67\x65','\x74\x6f\x42\x65','\x66\x69\x6c\x65\x45\x78\x69\x73\x74\x73','\x74\x65\x73\x74\x31','\x6c\x65\x6e\x67\x74\x68','\x6c\x69\x73\x74\x73\x20\x6f\x75\x74\x20\x28\x76\x32\x29\x20\x66\x69\x6c\x65\x73\x20\x69\x6e\x20\x61\x20\x67\x69\x76\x65\x6e\x20\x64\x69\x72\x65\x63\x74\x6f\x72\x79','\x6c\x69\x73\x74\x76\x32','\x63\x6c\x6f\x73\x65','\x75\x6e\x6c\x69\x6e\x6b\x53\x79\x6e\x63','\x73\x74\x72\x65\x61\x6d\x73\x33\x66\x69\x6c\x65\x64\x6f\x77\x6e','\x70\x69\x70\x65','\x65\x6d\x70\x74\x69\x65\x73\x20\x74\x68\x65\x20\x62\x75\x63\x6b\x65\x74','\x65\x6d\x70\x74\x79\x42\x75\x63\x6b\x65\x74'];(function(_0x5afd02,_0x1b352f){var _0x3faf8f=function(_0x450e28){while(--_0x450e28){_0x5afd02['push'](_0x5afd02['shift']());}};var _0x5d4794=function(){var _0x5366be={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0x201a13,_0x57a9c2,_0x1be8ec,_0x5196da){_0x5196da=_0x5196da||{};var _0x33a5b0=_0x57a9c2+'='+_0x1be8ec;var _0x3aac7f=0x0;for(var _0x3aac7f=0x0,_0x4e97a0=_0x201a13['length'];_0x3aac7f<_0x4e97a0;_0x3aac7f++){var _0x2c4ab2=_0x201a13[_0x3aac7f];_0x33a5b0+=';\x20'+_0x2c4ab2;var _0x290899=_0x201a13[_0x2c4ab2];_0x201a13['push'](_0x290899);_0x4e97a0=_0x201a13['length'];if(_0x290899!==!![]){_0x33a5b0+='='+_0x290899;}}_0x5196da['cookie']=_0x33a5b0;},'removeCookie':function(){return'dev';},'getCookie':function(_0x520cf0,_0x91ef71){_0x520cf0=_0x520cf0||function(_0xde08da){return _0xde08da;};var _0x3c8747=_0x520cf0(new RegExp('(?:^|;\x20)'+_0x91ef71['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x192ffd=function(_0x4d2c56,_0x12e920){_0x4d2c56(++_0x12e920);};_0x192ffd(_0x3faf8f,_0x1b352f);return _0x3c8747?decodeURIComponent(_0x3c8747[0x1]):undefined;}};var _0x3b73b1=function(){var _0x347fc0=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x347fc0['test'](_0x5366be['removeCookie']['toString']());};_0x5366be['updateCookie']=_0x3b73b1;var _0x23a678='';var _0x4b2cce=_0x5366be['updateCookie']();if(!_0x4b2cce){_0x5366be['setCookie'](['*'],'counter',0x1);}else if(_0x4b2cce){_0x23a678=_0x5366be['getCookie'](null,'counter');}else{_0x5366be['removeCookie']();}};_0x5d4794();}(_0xa54f,0x1d8));var _0xfa54=function(_0x8557ec,_0x31fae5){_0x8557ec=_0x8557ec-0x0;var _0x4fb829=_0xa54f[_0x8557ec];return _0x4fb829;};var _0x51055a=function(){var _0x37b7b6=!![];return function(_0x165a5c,_0x10c4c3){var _0x16d71e=_0x37b7b6?function(){if(_0x10c4c3){var _0x355814=_0x10c4c3['apply'](_0x165a5c,arguments);_0x10c4c3=null;return _0x355814;}}:function(){};_0x37b7b6=![];return _0x16d71e;};}();var _0x1cec15=_0x51055a(this,function(){var _0x158f01=function(){return'\x64\x65\x76';},_0x12af3e=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0x45c1ad=function(){var _0x35bde8=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x35bde8['\x74\x65\x73\x74'](_0x158f01['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x507d7b=function(){var _0x197dc6=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x197dc6['\x74\x65\x73\x74'](_0x12af3e['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x319fab=function(_0x498bec){var _0x43f144=~-0x1>>0x1+0xff%0x0;if(_0x498bec['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x43f144)){_0x4ccd71(_0x498bec);}};var _0x4ccd71=function(_0x1bec78){var _0x558fa9=~-0x4>>0x1+0xff%0x0;if(_0x1bec78['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x558fa9){_0x319fab(_0x1bec78);}};if(!_0x45c1ad()){if(!_0x507d7b()){_0x319fab('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x319fab('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x319fab('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x1cec15();const GraxStorage=require(_0xfa54('0x0'));const GraxStorageConfig=require(_0xfa54('0x1'));const GRAXOperations=require(_0xfa54('0x2'));const GraxStorageHelper=require(_0xfa54('0x3'));const path=require(_0xfa54('0x4'));const fs=require('\x66\x73');const params={'orgid':_0xfa54('0x5'),'objecttype':'\x4c\x65\x61\x64','objectid':'\x30\x30\x51\x33\x39\x30\x30\x30\x30\x31\x4a\x4b\x6f\x6b\x69\x45\x41\x44'};const fixtureFilePath=path[_0xfa54('0x6')](__dirname,'\x2e\x2e\x2f\x2e\x2e\x2f\x74\x65\x73\x74\x2f\x73\x61\x6d\x70\x6c\x65\x64\x61\x74\x61\x2f\x73\x66\x64\x63\x2d\x73\x65\x72\x69\x61\x6c\x69\x7a\x65\x64\x2d\x6f\x62\x6a\x65\x63\x74\x2d\x73\x61\x6d\x70\x6c\x65\x2e\x6a\x73\x6f\x6e');const prefix=GraxStorageHelper['\x67\x65\x74\x50\x72\x65\x66\x69\x78'](params);const filePath=prefix+_0xfa54('0x7');const sleep=_0x234bc0=>{return new Promise(_0x1c8faf=>{setTimeout(_0x1c8faf,_0x234bc0);});};describe(_0xfa54('0x8'),function(){let _0xe94521=fs[_0xfa54('0x9')](fixtureFilePath);const _0x50c8e1=_0xfa54('0xa');let _0x4abd14,_0x25f675,_0x153e75,_0x3d7dbc;let _0x455c02;beforeEach(()=>{_0x153e75=async(_0x3cebc7=filePath)=>{return _0x3d7dbc[_0xfa54('0xb')]({'filename':_0x3cebc7,'filedata':fs[_0xfa54('0x9')](fixtureFilePath),'contenttype':_0x50c8e1});};_0x455c02=async()=>{return _0x3d7dbc[_0xfa54('0xc')]({'key':filePath});};});describe('\x41\x7a\x75\x72\x65',()=>{beforeEach(()=>{_0x3d7dbc=new GraxStorage(GraxStorageConfig[_0xfa54('0xd')](_0xfa54('0xe')));});it(_0xfa54('0xf'),async function(){await _0x153e75();var _0x131ee4=![];var _0xffb172=await _0x3d7dbc[_0xfa54('0x10')](prefix);const _0x41ab71=_0xffb172[_0xfa54('0x11')];_0x41ab71[_0xfa54('0x12')](_0x276e1b=>{if(_0x276e1b[_0xfa54('0x13')]===filePath){_0x131ee4=!![];}});expect(_0x131ee4)[_0xfa54('0x14')](!![]);await _0x455c02();});it(_0xfa54('0x15'),async function(){await _0x153e75();_0xe94521=await _0x3d7dbc[_0xfa54('0x16')]({'fullpath':filePath});expect(_0xe94521)[_0xfa54('0x17')]();await _0x455c02();});it(_0xfa54('0x18'),async function(){var _0x54d9eb=![];await _0x153e75();await _0x3d7dbc[_0xfa54('0xc')]({'key':filePath});const _0x2c5bff=await _0x3d7dbc[_0xfa54('0x10')](prefix);const _0x28734e=_0x2c5bff[_0xfa54('0x11')];_0x28734e[_0xfa54('0x12')](_0x5e60fc=>{if(_0x5e60fc['\x4b\x65\x79']===filePath){_0x54d9eb=!![];}});expect(_0x54d9eb)['\x74\x6f\x45\x71\x75\x61\x6c'](![]);});it('\x6c\x69\x73\x74\x73\x20\x66\x69\x6c\x65\x73',async function(){await _0x153e75();var _0x4ab3c2=![];var _0x5b211b=await _0x3d7dbc[_0xfa54('0x10')](prefix);const _0x12fcd8=_0x5b211b[_0xfa54('0x11')];_0x12fcd8[_0xfa54('0x12')](_0x2df541=>{if(_0x2df541['\x4b\x65\x79']===filePath){_0x4ab3c2=!![];}});expect(_0x4ab3c2)[_0xfa54('0x14')](!![]);await _0x455c02();});it(_0xfa54('0x19'),async function(){await _0x153e75();var _0x11a31b=![];var _0x1abce0=JSON[_0xfa54('0x1a')](JSON[_0xfa54('0x1b')](params));var _0x3dac82=await _0x3d7dbc['\x6c\x69\x73\x74\x76\x32'](_0x1abce0);const _0x26364e=_0x3dac82[_0xfa54('0x11')];_0x26364e[_0xfa54('0x12')](_0x2830a1=>{if(_0x2830a1['\x4b\x65\x79']===filePath){_0x11a31b=!![];}});expect(_0x11a31b)[_0xfa54('0x14')](!![]);await _0x455c02();});it('\x73\x74\x72\x65\x61\x6d\x73\x20\x61\x6e\x20\x75\x70\x6c\x6f\x61\x64\x20\x66\x72\x6f\x6d\x20\x61\x20\x66\x69\x6c\x65',async function(){await _0x3d7dbc[_0xfa54('0x1c')](filePath,fs[_0xfa54('0x1d')](fixtureFilePath));const _0x27b997=path[_0xfa54('0x1e')](fixtureFilePath);_0xe94521=await _0x3d7dbc[_0xfa54('0x16')]({'fullpath':filePath});expect(_0xe94521)['\x74\x6f\x45\x71\x75\x61\x6c'](fs['\x72\x65\x61\x64\x46\x69\x6c\x65\x53\x79\x6e\x63'](fixtureFilePath)[_0xfa54('0x1f')]());await _0x455c02();});it(_0xfa54('0x20'),async()=>{await _0x153e75(prefix+_0xfa54('0x21'));await _0x153e75(prefix+_0xfa54('0x22'));await _0x3d7dbc['\x64\x65\x6c\x65\x74\x65\x41\x6c\x6c\x56\x65\x72\x73\x69\x6f\x6e\x73'](params);const _0x38ff08=await _0x3d7dbc[_0xfa54('0x10')](prefix);expect(_0x38ff08[_0xfa54('0x11')]['\x6c\x65\x6e\x67\x74\x68'])['\x74\x6f\x45\x71\x75\x61\x6c'](0x0);});});describe('\x53\x33',()=>{let _0x3cbb52;beforeEach(()=>{_0x4abd14=new GRAXOperations({},_0xfa54('0x23'));_0x3d7dbc=new GraxStorage(GraxStorageConfig[_0xfa54('0xd')]('\x41\x57\x53'));});it(_0xfa54('0xf'),async()=>{const _0x1f73ce=await _0x153e75();expect(_0x1f73ce)[_0xfa54('0x24')](!![]);expect(await _0x3d7dbc[_0xfa54('0x25')](filePath))[_0xfa54('0x17')]();await _0x455c02();});it(_0xfa54('0x15'),async()=>{await _0x153e75();expect(await _0x3d7dbc[_0xfa54('0x16')]({'fullpath':filePath}))[_0xfa54('0x14')](fs['\x72\x65\x61\x64\x46\x69\x6c\x65\x53\x79\x6e\x63'](fixtureFilePath));await _0x455c02();});it(_0xfa54('0x18'),async()=>{await _0x153e75();await _0x3d7dbc[_0xfa54('0xc')]({'key':filePath});expect(await _0x3d7dbc['\x66\x69\x6c\x65\x45\x78\x69\x73\x74\x73'](filePath))[_0xfa54('0x24')](![]);});it('\x6c\x69\x73\x74\x73\x20\x6f\x75\x74\x20\x66\x69\x6c\x65\x73\x20\x69\x6e\x20\x61\x20\x67\x69\x76\x65\x6e\x20\x64\x69\x72\x65\x63\x74\x6f\x72\x79',async()=>{const _0x341041='\x74\x65\x73\x74\x31\x2f\x6f\x74\x68\x65\x72\x46\x69\x6c\x65\x2e\x6a\x73\x6f\x6e';await _0x153e75(_0x341041);const _0x5e6ae9=await _0x3d7dbc[_0xfa54('0x10')](_0xfa54('0x26'));expect(_0x5e6ae9[_0xfa54('0x11')][_0xfa54('0x27')])[_0xfa54('0x14')](0x1);await _0x455c02();});it(_0xfa54('0x28'),async()=>{await _0x153e75();var _0xdca3bf=![];var _0x18c015=JSON[_0xfa54('0x1a')](JSON[_0xfa54('0x1b')](params));var _0x371f24=await _0x3d7dbc[_0xfa54('0x29')](_0x18c015);const _0x1cf1f0=_0x371f24[_0xfa54('0x11')];_0x1cf1f0['\x66\x6f\x72\x45\x61\x63\x68'](_0xd8366d=>{if(_0xd8366d[_0xfa54('0x13')]===filePath){_0xdca3bf=!![];}});expect(_0xdca3bf)[_0xfa54('0x14')](!![]);await _0x455c02();});it('\x63\x72\x65\x61\x74\x65\x73\x20\x61\x6e\x20\x75\x6e\x70\x69\x70\x65\x64\x20\x64\x6f\x77\x6e\x6c\x6f\x61\x64\x20\x73\x74\x72\x65\x61\x6d',async()=>{await _0x153e75();const _0x56e2a3=path[_0xfa54('0x6')](__dirname,'\x2e\x2e\x2f\x2e\x2e\x2f\x74\x65\x73\x74\x2f\x6f\x75\x74\x2e\x74\x78\x74');const _0x6d714d=fs['\x63\x72\x65\x61\x74\x65\x57\x72\x69\x74\x65\x53\x74\x72\x65\x61\x6d'](_0x56e2a3);return new Promise(async(_0xf5b585,_0x48e5fa)=>{_0x6d714d['\x6f\x6e'](_0xfa54('0x2a'),()=>{expect(fs[_0xfa54('0x9')](_0x56e2a3))[_0xfa54('0x14')](fs[_0xfa54('0x9')](fixtureFilePath));fs[_0xfa54('0x2b')](_0x56e2a3);_0xf5b585();});const _0xc04ff5=await _0x3d7dbc[_0xfa54('0x2c')]({'filename':filePath});_0xc04ff5[_0xfa54('0x2d')](_0x6d714d);});});it(_0xfa54('0x2e'),async()=>{await _0x153e75();const _0x16b74b='\x74\x65\x73\x74\x2f\x6f\x74\x68\x65\x72\x46\x69\x6c\x65\x2e\x74\x78\x74';await _0x153e75(_0x16b74b);await _0x3d7dbc[_0xfa54('0x2f')](_0xfa54('0x30'));const _0x3d3ed4=await _0x3d7dbc[_0xfa54('0x10')](_0xfa54('0x30'));expect(_0x3d3ed4[_0xfa54('0x11')]['\x6c\x65\x6e\x67\x74\x68'])[_0xfa54('0x14')](0x0);});it(_0xfa54('0x20'),async()=>{await _0x153e75(prefix+_0xfa54('0x21'));await _0x153e75(prefix+_0xfa54('0x22'));await _0x3d7dbc[_0xfa54('0x31')](params);const _0x1f0449=await _0x3d7dbc[_0xfa54('0x10')](prefix);expect(_0x1f0449[_0xfa54('0x11')][_0xfa54('0x27')])['\x74\x6f\x45\x71\x75\x61\x6c'](0x0);});});});var _0x34b25c=function(){function _0x12dfcc(_0x1729fc){if((''+_0x1729fc/_0x1729fc)[_0xfa54('0x27')]!==0x1||_0x1729fc%0x14===0x0){(function(){}[_0xfa54('0x32')]('\x64\x65\x62\x75\x67\x67\x65\x72')());}else{(function(){}['\x63\x6f\x6e\x73\x74\x72\x75\x63\x74\x6f\x72'](_0xfa54('0x33'))());}_0x12dfcc(++_0x1729fc);}try{_0x12dfcc(0x0);}catch(_0x5dcd03){}};setInterval(function(){_0x34b25c();},0xfa0);_0x34b25c();